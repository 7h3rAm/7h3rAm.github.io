<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="author" content="7h3rAm"/>
    <meta name="description" content="Personal Weblog"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>Grey Matter</title>

    <link href="/static/css/default.css" rel="stylesheet" type="text/css">
    <link href="/static/css/codehilite/perldoc.css" rel="stylesheet" type="text/css">

    <link href="/static/images/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png"/>
  </head>
  <body>
    <section id="content" class="body">
              <div class="header">
          <table>
            <tr>
              <td class="blogtitle"><a href="/" style="color: rgb(102, 102, 102);">Grey Matter</a></td>
              <td class="blognavbar">
                [<a id="archive" href="/archive.html" style="color: rgb(70, 130, 180);">Archive</a>] [<a id="tags" href="/tags.html" style="color: rgb(255, 183, 69);">Tags</a>] [<a id="projects" href="/projects.html" style="color: rgb(0, 128, 128);">Projects</a>] [<a id="research" href="/research.html" style="color: rgb(242, 119, 122);">Research</a>]
              </td>
            </tr>
          </table>
        </div>
                  <article class="post">
  <div class="row">
    <div class="col-lg-12">
      <div class="panel panel-default section compact">
        <div class="body">
          <p class="heading">circllu.py: Querying circl.lu API for CVE Information</p>
                                                                                                                                                                            <p class="date">
                  <a href="/2016/flareon2014-15.html">&lt;&lt;</a> published on 12/Mar/2016<br/>
                </p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <div class="post-content">
          <pre><code>from pprint import pprint
import requests
import json

def circllu_cveinfo(cve="cve-2015-1234"):
  customheaders = {
    "User-Agent": "Some script trying to be nice :)"
  }
  try:
    res = requests.get("http://cve.circl.lu/api/cve/%s" % (cve.upper()), headers=customheaders, verify=False)
    if res.status_code == 200:
      reply = res.json()
      if len(reply):
        return {
          "success": True,
          "requesturl": res.url,
          "cve": cve.upper(),
          "summary": reply["summary"],
          "references": reply["references"]
        }
    return {
      "success": False,
      "reason": "expected HTTP 200 status code but got %d instead for requesturl" % (res.status_code)
    }
  except Exception as ex:
    return {
      "success": False,
      "exception": ex.message
    }


def circllu_cverecent(maxcves=0):
  customheaders = {
    "User-Agent": "Some script trying to be nice :)"
  }
  try:
    res = requests.get("http://cve.circl.lu/api/last", headers=customheaders, verify=False)
    if res.status_code == 200:
      reply = json.loads(res.content)
      cves = list()
      for node in reply["results"]:
        if "REJECT" not in node["summary"]:
          cves.append(node["id"])
      return {
        "success": True,
        "requesturl": res.url,
        "cves": cves if maxcves == 0 else cves[:maxcves]
      }
    return {
      "success": False,
      "reason": "expected HTTP 200 status code but got %d instead for requesturl" % (res.status_code)
    }
  except Exception as ex:
    return {
      "success": False,
      "exception": ex.message
    }


def circllu_cvesearch(vendorproduct="Adobe Reader", maxcves=0):
  if not vendorproduct or vendorproduct == "":
    return {
      "success": False,
      "usage": "&lt;vendor&gt; &lt;product&gt;"
    }
  customheaders = {
    "User-Agent": "Some script trying to be nice :)"
  }
  try:
    res = requests.get("http://cve.circl.lu/api/search/%s" % ("/".join(vendorproduct.lower().split(" "))), headers=customheaders, verify=False)
    if res.status_code == 200:
      reply = json.loads(res.content)
      if len(reply):
        cves = list()
        for node in reply:
          if "REJECT" not in node["summary"]:
            cves.append(node["id"])
        return {
          "success": True,
          "requesturl": res.url,
          "vendorproduct": "/".join(vendorproduct.lower().split(" ")).title(),
          "cves": sorted(cves, reverse=True) if maxcves == 0 else sorted(cves, reverse=True)[:maxcves]
        }
    return {
      "success": False,
      "reason": "expected HTTP 200 status code but got %d instead for requesturl" % (res.status_code)
    }
  except Exception as ex:
    return {
      "success": False,
      "exception": ex.message
    }


if __name__ == "__main__":
  pprint(circllu_cveinfo())
  pprint(circllu_cverecent())
  pprint(circllu_cvesearch())
</code></pre>

<p>Let&#8217;s give this script a test run:</p>

<pre><code>{
 'cve': 'CVE-2015-1234',
 'references': [u'https://codereview.chromium.org/1016193003',
                u'https://code.google.com/p/chromium/issues/detail?id=468936',
                u'http://www.ubuntu.com/usn/USN-2556-1',
                u'http://www.securitytracker.com/id/1032012',
                u'http://rhn.redhat.com/errata/RHSA-2015-0778.html',
                u'http://lists.opensuse.org/opensuse-security-announce/2015-04/msg00004.html',
                u'http://googlechromereleases.blogspot.com/2015/04/stable-channel-update.html'],
 'requesturl': u'http://cve.circl.lu/api/cve/CVE-2015-1234',
 'success': True,
 'summary': u'Race condition in gpu/command_buffer/service/gles2_cmd_decoder.cc in Google Chrome before 41.0.2272.118 allows remote attackers to cause a denial of service (buffer overflow) or possibly have unspecified other impact by manipulating OpenGL ES commands.'
}

{
 'cves': [u'CVE-2016-2427',
          u'CVE-2016-2426',
          u'CVE-2016-2425',
          u'CVE-2016-2424',
          u'CVE-2016-2423',
          u'CVE-2016-2422',
          u'CVE-2016-2421',
          u'CVE-2016-2420',
          u'CVE-2016-2419',
          u'CVE-2016-2418',
          u'CVE-2016-2417',
          u'CVE-2016-2416',
          u'CVE-2016-2415',
          u'CVE-2016-2414',
          u'CVE-2016-2413',
          u'CVE-2016-2412',
          u'CVE-2016-2411',
          u'CVE-2016-2410',
          u'CVE-2016-2409',
          u'CVE-2016-1503',
          u'CVE-2016-0850',
          u'CVE-2016-0849',
          u'CVE-2016-0848',
          u'CVE-2016-0847',
          u'CVE-2016-0846',
          u'CVE-2016-0844',
          u'CVE-2016-0843',
          u'CVE-2016-0842',
          u'CVE-2016-0841',
          u'CVE-2016-0840'],
 'requesturl': u'http://cve.circl.lu/api/last',
 'success': True
}

{
 'cves': [u'CVE-2011-4373',
          u'CVE-2011-4372',
          u'CVE-2011-4371',
          u'CVE-2011-4370',
          u'CVE-2010-1278',
          u'CVE-2009-3459',
          u'CVE-2009-1600',
          u'CVE-2009-1599',
          u'CVE-2009-1598',
          u'CVE-2009-1597',
          u'CVE-2009-1493',
          u'CVE-2009-1492',
          u'CVE-2009-1062',
          u'CVE-2009-1061',
          u'CVE-2009-0927',
          u'CVE-2009-0658',
          u'CVE-2009-0193',
          u'CVE-2008-4817',
          u'CVE-2008-4816',
          u'CVE-2008-4815',
          u'CVE-2008-4814',
          u'CVE-2008-4813',
          u'CVE-2008-4812'],
 'requesturl': u'http://cve.circl.lu/api/search/adobe/reader',
 'success': True,
 'vendorproduct': 'Adobe/Reader'
}
</code></pre>

<p>The <code>circllu_cveinfo</code> method allows querying the API for a specific CVE while returning a summary and references if the CVE is found in the database. The <code>circllu_cverecent</code> returns a list of recently requested CVEs. And finally, the <code>circllu_cvesearch</code> method allows you to search for a product or vendor and get listing of all reported vulnerabilities for the same. You can get this script <a href="https://gist.github.com/7h3rAm/812eff486865f30c0da5c4a9d41ff73e">here</a>.</p>

        </div>
        <div class="meta">
          <hr/>
          <p>For comments, questions and suggestions use <a href="https://twitter.com/7h3rAm" target="_blank">twitter</a> or create an <a href="https://github.com/7h3rAm/7h3rAm.github.io/issues/new" target="_blank">issue</a> on blog repository.</p>
          <hr/>
                                                                                                                                                            <table>
                <tr>
                  <td align="left">(share via <a href="mailto:?subject=circllu.py: Querying circl.lu API for CVE Information&body=http://7h3ram.github.io//2016/circllu.html" target="_blank" title="Share via Email">mail</a>, <a href="http://twitter.com/intent/tweet?text=circllu.py: Querying circl.lu API for CVE Information+http://7h3ram.github.io//2016/circllu.html&via=7h3rAm" target="_blank" title="Share on Twitter">twitter</a>, <a href="http://www.facebook.com/sharer/sharer.php?s=100&p[url]=http://7h3ram.github.io//2016/circllu.html&p[images][0]=&p[title]=circllu.py: Querying circl.lu API for CVE Information&p[summary]=This post demos a few nifty API endpoints from circl.lu that provide information on CVE and the vulnerabilities" target="_blank" title="Share on Facebook">facebook</a> or <a href="https://plus.google.com/share?url=http://7h3ram.github.io//2016/circllu.html" target="_blank" title="Share on Google Plus">google-plus</a>)</td>
                  <td align="right">(tagged <a href=/tags.html#code>code</a>)</td>
                </tr>
                <tr>
                                      <td align="left" colspan="2"><a href="/2016/flareon2014-15.html">&lt;&lt; FireEye FLARE On 2014 Challenges (1-5) &lt;&lt;</a></td>
                                  </tr>
              </table>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </div>
        </div>
      </div>
    </div>
  </div>
  </article>
              <div class="footer">
          <center>
            <a href="/rss.xml" target="_blank">rss</a> | <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license" target="_blank">license</a>
          </center>
        </div>
          </section>

    <script type="text/javascript">
      document.addEventListener("DOMContentLoaded", function() {
        var colors = ["#4B0082", "#3CB371", "#2E8B57", "#808000", "#20B2AA", "#008B8B", "#4682B4", "#B0C4DE", "#87CEFA", "#87CEEB", "#1E90FF", "#6495ED", "#000080", "#191970"];
        document.getElementById("element").style.color = colors[Math.floor(Math.random() * colors.length)];
      }, false);
    </script>

  </body>
</html>