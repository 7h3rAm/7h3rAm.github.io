<!DOCTYPE html>
<html lang="en" data-theme-mode="light">
<head>
  <meta charset="utf-8">
  <meta name="author" content="Ankur Tyagi (7h3rAm)">
  <meta name="description" content="Personal Weblog">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Manthan</title>
  <link rel="icon" type="image/webp" sizes="32x32" href="/static/images/manthan-32x32.png.webp">
  <link rel="stylesheet" href="/static/css/base.css">
  <link rel="stylesheet" href="/static/css/atelier-forest-light.css">
  <script src="/static/js/theme.js"></script>
  <script src="/static/js/highlight.min.js"></script>
  <script src="/static/js/hljs-bash.min.js"></script>
  <script src="/static/js/hljs-python.min.js"></script>
  <script src="/static/js/hljs-sql.min.js"></script>
  <script src="/static/js/hljs-powershell.min.js"></script>
  <script src="/static/js/hljs-line-numbers.min.js"></script>
</head>
<body>

<header>
  <div class="header-top">
    <div class="title-wrapper">
      <h1 class="site-title"><a href="/" style="color:inherit;text-decoration:none;">manthan</a></h1>
      <span class="meta">security research | code | writeups</span>
    </div>
    <div class="nav-and-toggles">
      <div class="nav-links">
        <a href="/archive.html">archive</a>
        <a href="/tags.html">tags</a>
        <a href="/stats.html">stats</a>
      </div>
      <div class="toggle-buttons">
        <button class="toggle-btn toggle-theme" onclick="toggleThemeMode()">&#xf05a8;</button>
        <button class="toggle-btn toggle-density" onclick="toggleDensity()">&#xf084f;</button>
        <button class="toggle-btn toggle-width" onclick="toggleWidth()">&#xf084e;</button>
        <button class="toggle-btn toggle-justify" onclick="toggleJustify()">&#xf039;</button>
        <button class="toggle-btn toggle-collapse" onclick="toggleAllSections()">&#xf151;</button>
      </div>
    </div>
  </div>
</header>

<article id="top">
  <div class="post-header">
    <div style="display:flex; justify-content:space-between; align-items:flex-start;">
      <div>
        <h1 class="post-title" style="margin:0;">circllu.py: Querying circl.lu API for CVE Information</h1>
      </div>
      <div class="meta" style="text-align:right;">
        <div>12/Mar/2016</div>
        <div class="tags"><a href="/tags.html#code">code</a></div>
      </div>
    </div>
  </div>

  <div class="content">
    <h2 class="h2 collapsible" onclick="toggle(this);">Introduction</h2>
<p class="nested active">The <a href="https://www.circl.lu/services/cve-search/#public-web-api-of-cve-search">circl.lu</a> API is really useful for querying CVE information. I wrote a few methods to query the API and get this information:</p>
<pre class="nested active"><code class="language-python">from pprint import pprint
import requests
import json

def circllu_cveinfo(cve=&quot;cve-2015-1234&quot;):
  customheaders = {
    &quot;User-Agent&quot;: &quot;Some script trying to be nice :)&quot;
  }
  try:
    res = requests.get(&quot;http://cve.circl.lu/api/cve/%s&quot; % (cve.upper()), headers=customheaders, verify=False)
    if res.status_code == 200:
      reply = res.json()
      if len(reply):
        return {
          &quot;success&quot;: True,
          &quot;requesturl&quot;: res.url,
          &quot;cve&quot;: cve.upper(),
          &quot;summary&quot;: reply[&quot;summary&quot;],
          &quot;references&quot;: reply[&quot;references&quot;]
        }
    return {
      &quot;success&quot;: False,
      &quot;reason&quot;: &quot;expected HTTP 200 status code but got %d instead for requesturl&quot; % (res.status_code)
    }
  except Exception as ex:
    return {
      &quot;success&quot;: False,
      &quot;exception&quot;: ex.message
    }


def circllu_cverecent(maxcves=0):
  customheaders = {
    &quot;User-Agent&quot;: &quot;Some script trying to be nice :)&quot;
  }
  try:
    res = requests.get(&quot;http://cve.circl.lu/api/last&quot;, headers=customheaders, verify=False)
    if res.status_code == 200:
      reply = json.loads(res.content)
      cves = list()
      for node in reply[&quot;results&quot;]:
        if &quot;REJECT&quot; not in node[&quot;summary&quot;]:
          cves.append(node[&quot;id&quot;])
      return {
        &quot;success&quot;: True,
        &quot;requesturl&quot;: res.url,
        &quot;cves&quot;: cves if maxcves == 0 else cves[:maxcves]
      }
    return {
      &quot;success&quot;: False,
      &quot;reason&quot;: &quot;expected HTTP 200 status code but got %d instead for requesturl&quot; % (res.status_code)
    }
  except Exception as ex:
    return {
      &quot;success&quot;: False,
      &quot;exception&quot;: ex.message
    }


def circllu_cvesearch(vendorproduct=&quot;Adobe Reader&quot;, maxcves=0):
  if not vendorproduct or vendorproduct == &quot;&quot;:
    return {
      &quot;success&quot;: False,
      &quot;usage&quot;: &quot;&lt;vendor&gt; &lt;product&gt;&quot;
    }
  customheaders = {
    &quot;User-Agent&quot;: &quot;Some script trying to be nice :)&quot;
  }
  try:
    res = requests.get(&quot;http://cve.circl.lu/api/search/%s&quot; % (&quot;/&quot;.join(vendorproduct.lower().split(&quot; &quot;))), headers=customheaders, verify=False)
    if res.status_code == 200:
      reply = json.loads(res.content)
      if len(reply):
        cves = list()
        for node in reply:
          if &quot;REJECT&quot; not in node[&quot;summary&quot;]:
            cves.append(node[&quot;id&quot;])
        return {
          &quot;success&quot;: True,
          &quot;requesturl&quot;: res.url,
          &quot;vendorproduct&quot;: &quot;/&quot;.join(vendorproduct.lower().split(&quot; &quot;)).title(),
          &quot;cves&quot;: sorted(cves, reverse=True) if maxcves == 0 else sorted(cves, reverse=True)[:maxcves]
        }
    return {
      &quot;success&quot;: False,
      &quot;reason&quot;: &quot;expected HTTP 200 status code but got %d instead for requesturl&quot; % (res.status_code)
    }
  except Exception as ex:
    return {
      &quot;success&quot;: False,
      &quot;exception&quot;: ex.message
    }


if __name__ == &quot;__main__&quot;:
  pprint(circllu_cveinfo())
  pprint(circllu_cverecent())
  pprint(circllu_cvesearch())
</code></pre>
<h2 class="h2 collapsible" onclick="toggle(this);">Testing</h2>
<p class="nested active">Let's give this script a test run:</p>
<pre class="nested active"><code>{
 'cve': 'CVE-2015-1234',
 'references': [u'https://codereview.chromium.org/1016193003',
                u'https://code.google.com/p/chromium/issues/detail?id=468936',
                u'http://www.ubuntu.com/usn/USN-2556-1',
                u'http://www.securitytracker.com/id/1032012',
                u'http://rhn.redhat.com/errata/RHSA-2015-0778.html',
                u'http://lists.opensuse.org/opensuse-security-announce/2015-04/msg00004.html',
                u'http://googlechromereleases.blogspot.com/2015/04/stable-channel-update.html'],
 'requesturl': u'http://cve.circl.lu/api/cve/CVE-2015-1234',
 'success': True,
 'summary': u'Race condition in gpu/command_buffer/service/gles2_cmd_decoder.cc in Google Chrome before 41.0.2272.118 allows remote attackers to cause a denial of service (buffer overflow) or possibly have unspecified other impact by manipulating OpenGL ES commands.'
}

{
 'cves': [u'CVE-2016-2427',
          u'CVE-2016-2426',
          u'CVE-2016-2425',
          u'CVE-2016-2424',
          u'CVE-2016-2423',
          u'CVE-2016-2422',
          u'CVE-2016-2421',
          u'CVE-2016-2420',
          u'CVE-2016-2419',
          u'CVE-2016-2418',
          u'CVE-2016-2417',
          u'CVE-2016-2416',
          u'CVE-2016-2415',
          u'CVE-2016-2414',
          u'CVE-2016-2413',
          u'CVE-2016-2412',
          u'CVE-2016-2411',
          u'CVE-2016-2410',
          u'CVE-2016-2409',
          u'CVE-2016-1503',
          u'CVE-2016-0850',
          u'CVE-2016-0849',
          u'CVE-2016-0848',
          u'CVE-2016-0847',
          u'CVE-2016-0846',
          u'CVE-2016-0844',
          u'CVE-2016-0843',
          u'CVE-2016-0842',
          u'CVE-2016-0841',
          u'CVE-2016-0840'],
 'requesturl': u'http://cve.circl.lu/api/last',
 'success': True
}

{
 'cves': [u'CVE-2011-4373',
          u'CVE-2011-4372',
          u'CVE-2011-4371',
          u'CVE-2011-4370',
          u'CVE-2010-1278',
          u'CVE-2009-3459',
          u'CVE-2009-1600',
          u'CVE-2009-1599',
          u'CVE-2009-1598',
          u'CVE-2009-1597',
          u'CVE-2009-1493',
          u'CVE-2009-1492',
          u'CVE-2009-1062',
          u'CVE-2009-1061',
          u'CVE-2009-0927',
          u'CVE-2009-0658',
          u'CVE-2009-0193',
          u'CVE-2008-4817',
          u'CVE-2008-4816',
          u'CVE-2008-4815',
          u'CVE-2008-4814',
          u'CVE-2008-4813',
          u'CVE-2008-4812'],
 'requesturl': u'http://cve.circl.lu/api/search/adobe/reader',
 'success': True,
 'vendorproduct': 'Adobe/Reader'
}
</code></pre>
<h2 class="h2 collapsible" onclick="toggle(this);">Conclusion</h2>
<p class="nested active">The <code>circllu_cveinfo</code> method allows querying the API for a specific CVE while returning a summary and references if the CVE is found in the database. The <code>circllu_cverecent</code> returns a list of recently requested CVEs. And finally, the <code>circllu_cvesearch</code> method allows you to search for a product or vendor and get listing of all reported vulnerabilities for the same. You can get this script <a href="https://gist.github.com/7h3rAm/812eff486865f30c0da5c4a9d41ff73e">here</a>.</p>
  </div>

  <nav class="post-nav" style="margin-top:1em;">
    <a class="nav-prev" href="/posts/20160218_flareon2014-15.html"><span class="arrow">&lt;&lt;&lt;</span> <span class="nav-title">FireEye FLARE On 2014 Challenges (1-5)</span></a>    <a class="nav-next" href="/posts/20190831_vulnhub-brainpan.html"><span class="nav-title">[VulnHub] Brainpan: 1</span> <span class="arrow">&gt;&gt;&gt;</span></a>  </nav>
</article>

<script>
document.addEventListener('DOMContentLoaded', function() {
  var content = document.querySelector('.content');
  if (content) {
    var headings = content.querySelectorAll('h2,h3,h4,h5,h6');
    headings.forEach(function(h) {
      var link = document.createElement('a');
      link.href = '#top';
      link.className = 'top-link';
      link.textContent = ' [^]';
      link.style.fontSize = '0.8em';
      link.style.color = 'var(--muted)';
      h.appendChild(link);
    });
  }
});
</script>

<footer>
  <p class="nested active">cc-by-sa-4.0</p>
</footer>

<script>hljs.configure({ignoreUnescapedHTML: true}); hljs.highlightAll(); hljs.initLineNumbersOnLoad();</script>
</body>
</html>