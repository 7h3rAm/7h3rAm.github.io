<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta name=author content="Ankur Tyagi (@7h3rAm)"><meta name=description content="Personal Weblog"><meta content="width=device-width, initial-scale=1" name=viewport><title>à¤®à¤‚à¤¥à¤¨ | Manthan</title><link href=/static/images/manthan-32x32.png.webp sizes=32x32 rel=icon type=image/webp><script src=/static/js/highlight.min.js></script><script src=/static/js/highlightjs-line-numbers.min.js></script><script charset=UTF-8 src=/static/js/go.min.js></script><link rel=stylesheet href=/static/css/github-gist.min.css><link rel=stylesheet type=text/css href=/static/css/style.md.post.css media=screen></head><body><div class=header><table><tr><td><a href=/index.html style="color:#fc580c; font-size:20pt; background-color:#fffffa;">à¤®à¤‚à¤¥à¤¨</a></td><td> | </td><td><a href=/archive.html style="color:#20b2aa; font-size:18pt; background-color:#fffffa;">Archive</a></td><td> | </td><td><a href=/tags.html style="color:#fe4164; font-size:18pt; background-color:#fffffa;">Tags</a></td><td> | </td><td><a href=/stats.html style="color:#69359c; font-size:18pt; background-color:#fffffa;">Stats</a></td></tr></table></div><div class=body><h1 class="h1 collapsible" onclick=toggle(this);>Northrop's Online Challenge</h1><p><a href=/posts/20140318_shellcode-pipeline.html> Â« </a>ðŸ“… published on <code>27/Mar/2014</code><a href=/posts/20140506_confidence-ds-ctf-stego50.html> Â» </a></p><h2 class="h2 collapsible" onclick=toggle(this);>Introduction</h2><p class=nested>A while back I was checking out the <a href=http://www.reddit.com/r/netsec/comments/1ubzv9/rnetsecs_q1_2014_information_security_hiring/ >/r/netsec's Q1 2014 Information Security Hiring Thread</a> at Reddit and there I found an interesting challenge posted by someone from Northrop Grumman Cyber Intelligence Division. They were looking for people with interesting skills (IDS/IPS, Big Data, web app development, etc.) and mentioned that candidates solving their <a href=https://googledrive.com/host/0B7WgiVv_ihnhX1VRWHVXZmZmMW8/challengeWebpage.html>online challenge</a> will be preferred. I find such challenges really interesting and immediately got on top of it. A few hours later I solved it and decided to write about the process. This post details steps I took and lessons learned.</p><h2 class="h2 collapsible" onclick=toggle(this);>Research and Testing</h2><p class=nested>The online challenge page looks something like this:</p><p class=nested><img alt=onlinechallenge.png src=/static/files/posts_northrop_challenge/onlinechallenge.png.webp></p><p class=nested>It includes a <code>.png</code> image which, as mentioned, contains a hidden message that has to be found to solve the challenge. Here is the challenge image for your reference:</p><p class=nested><img alt=cryptImg.png src=/static/files/posts_northrop_challenge/cryptImg.png.webp></p><p class=nested>The first thing I did upon opening up this page was looking at its source. In there I found an <code>iframe</code> with a <code>png</code> file embedded in it. The <code>iframe</code> had a comment preceding it: <code>A frame for my key</code>. This suggested that the embedded image is a key of some kind that has to be used in the challenge. I immediately extracted it and here it is (in actual dimensions: 128x96):</p><p class=nested><img alt=key.png src=/static/files/posts_northrop_challenge/key.png.webp></p><p class=nested>There was also a hint in the page, a link to <a href=http://www.pythonware.com/products/pil/ >Python Imaging Library (PIL)</a>, which suggested that some image manipulation would be needed to find the hidden message. Before exploring the python library I thought of spending some time with the challenge image itself, though not exactly sure of what I was looking for. The image seemed to have sections in it, actually a grid like structure, comprising of 5x5 cells (ie. a total of 25 sections). Interestingly, the key image is exactly 1/5th the size of challenge image. I immediately had the idea that the base image might be mutated with key image operating on each of its 25 sections individually. This mutation created a seemingly gibberish image with lots of noise but failed to hide the algorithm's cellular structure. The only unknown at this time was the mutation algorithm, which I assumed to be XOR. I immediately crafted a poc to test this hypothesis. It downloads the <code>.html</code> webpage, the <code>.png</code> challenge image, extract <code>.png</code> key file and performs a XOR between the challenge and the key image, on a per cell fashion, rounding up the start of each cell with the start of the key file. Once this operation is completed over all 25 cells, the decoded image will be saved as a <code>.png</code> to disk. Here is a test run:</p><pre class=nested><code class=python>$ ./cry.py

[+] Downloading challenge webpage: https://googledrive.com/host/0B7WgiVv_ihnhX1VRWHVXZmZmMW8challengeWebpage.html ...
[+] Downloading basefile: https://googledrive.com/host/0B7WgiVv_ihnhX1VRWHVXZmZmMW8/cryptImg.png ...
[+] Extracting keyfile: key.png ...

[+] cryptImg.png: (RGB, (640, 480))
[+] key.png: (RGBA, (128, 96))

[+] Decoding basefile: cryptImg.png XOR keyfile: key.png ...
[+] Decoding complete! Saved to decoded.png: (RGB, (640, 480))
</code></pre><p class=nested>And here is the <code>decoded.png</code> image file:</p><p class=nested><img alt=decoded.png src=/static/files/posts_northrop_challenge/decoded.png.webp></p><h2 class="h2 collapsible" onclick=toggle(this);>Conclusion</h2><p class=nested>This indeed was an interesting challenge and a one that proved to be good source of learning. Stay tuned for more writeups on similar topics.</p><p style=text-align:center;>(ðŸ”– tagged <a href=/tags.html#code>code</a> and <a href=/tags.html#ctf>ctf</a>)</p><p style=text-align:center;>Â« <a href=/posts/20140318_shellcode-pipeline.html>Shellcode Analysis Pipleine...</a> Â« | Â» <a href=/posts/20140506_confidence-ds-ctf-stego50.html>CONFidence DS CTF Teaser: Steg...</a> Â»</p></div><script>hljs.initHighlightingOnLoad();</script><script>hljs.initLineNumbersOnLoad();</script><script>function toggle(s){s.classList.toggle("expanded");var t=!1,i=!1,a=!1;s.classList.contains("h2")&&(t=!0),s.classList.contains("h3")&&(i=!0),s.classList.contains("h4")&&(a=!0),console.log(s),console.log(t),console.log(i),console.log(a);for(var l=s.nextElementSibling;l;){if(t&&l.classList.contains("h2")){l.classList.toggle("active");break}if(i&&(l.classList.contains("h2")||l.classList.contains("h3"))){l.classList.toggle("active");break}if(a&&(l.classList.contains("h2")||l.classList.contains("h3")||l.classList.contains("h4"))){l.classList.toggle("active");break}l.classList.contains("collapsible")&&l.classList.toggle("expanded"),l.classList.toggle("active"),l=l.nextElementSibling}}</script><div class=footer><p><a href=https://creativecommons.org/licenses/by-sa/4.0/ rel=license><img src=/static/files/ccbysa4.svg></a></p></div></body></html>