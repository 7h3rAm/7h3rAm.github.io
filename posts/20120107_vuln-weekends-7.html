<!DOCTYPE html>
<html lang="en" data-theme-mode="light">
<head>
  <meta charset="utf-8">
  <meta name="author" content="Ankur Tyagi (7h3rAm)">
  <meta name="description" content="Personal Weblog">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Manthan</title>
  <link rel="icon" type="image/webp" sizes="32x32" href="/static/images/manthan-32x32.png.webp">
  <link rel="stylesheet" href="/static/css/base.css">
  <link rel="stylesheet" href="/static/css/atelier-forest-light.css">
  <script src="/static/js/theme.js"></script>
  <script src="/static/js/highlight.min.js"></script>
  <script src="/static/js/hljs-bash.min.js"></script>
  <script src="/static/js/hljs-python.min.js"></script>
  <script src="/static/js/hljs-sql.min.js"></script>
  <script src="/static/js/hljs-powershell.min.js"></script>
  <script src="/static/js/hljs-line-numbers.min.js"></script>
</head>
<body>

<header>
  <div class="header-top">
    <div class="title-wrapper">
      <h1 class="site-title"><a href="/" style="color:inherit;text-decoration:none;">manthan</a></h1>
      <span class="meta">security research | code | writeups</span>
    </div>
    <div class="nav-and-toggles">
      <div class="nav-links">
        <a href="/archive.html">archive</a>
        <a href="/tags.html">tags</a>
        <a href="/stats.html">stats</a>
      </div>
      <div class="toggle-buttons">
        <button class="toggle-btn toggle-theme" onclick="toggleThemeMode()">&#xf05a8;</button>
        <button class="toggle-btn toggle-density" onclick="toggleDensity()">&#xf084f;</button>
        <button class="toggle-btn toggle-width" onclick="toggleWidth()">&#xf084e;</button>
        <button class="toggle-btn toggle-justify" onclick="toggleJustify()">&#xf039;</button>
        <button class="toggle-btn toggle-collapse" onclick="toggleAllSections()">&#xf151;</button>
      </div>
    </div>
  </div>
</header>

<article id="top">
  <div class="post-header">
    <div style="display:flex; justify-content:space-between; align-items:flex-start;">
      <div>
        <h1 class="post-title" style="margin:0;">Vulnerable Weekends #7: Iptools rcmd DoS</h1>
      </div>
      <div class="meta" style="text-align:right;">
        <div>07/Jan/2012</div>
        <div class="tags"><a href="/tags.html#vulnweekends">vulnweekends</a></div>
      </div>
    </div>
  </div>

  <div class="content">
    <h2 class="h2 collapsible" onclick="toggle(this);">Vulnerability Report #7: Iptools rcmd Denial of Service Vulnerability</h2>
<p class="nested active"><strong>Vulnerable Product</strong>: Installations of Iptools with version 0.1.4</p>
<p class="nested active"><strong>CVE ID</strong>: NA</p>
<p class="nested active"><strong>CVSS v2 Score</strong>:<br />
<strong>Access Vector</strong>: NETWORK<br />
<strong>Access Complexity</strong>: LOW<br />
<strong>Authentication</strong>: NONE  </p>
<p class="nested active"><strong>Confidentiality Impact</strong>: NONE<br />
<strong>Integrity Impact</strong>: NONE<br />
<strong>Availability Impact</strong>: PARTIAL<br />
<strong>Base Score</strong>: 5  </p>
<p class="nested active"><strong>Exploitability</strong>: PROOF-OF-CONCEPT<br />
<strong>Remediation Level</strong>: WORKAROUND<br />
<strong>Report Confidence</strong>: UNCORROBORATED<br />
<strong>Temporal Score</strong>: 4.1  </p>
<h3 class="h3 collapsible" onclick="toggle(this);">Details</h3>
<p class="nested active">Iptools is a popular set of tiny TCP/IP utilities implemented as Perl scripts, that include a minimalist webserver, a remote command server on the lines of Telnet, a TFTP server/client, SNMP browser, etc. The toolset has been reported to be vulnerable to a denial of service (DoS) vulnerability, specifically within its remote command server script, <code>rcmd</code>.</p>
<p class="nested active">The vulnerable utility receives user-supplied input through its listening port, TCP/23, which is then tested against a set of weak sanitization checks. This input is used as a placeholder for the <code>EXPR</code> parameter used by the internal <code>chdir</code> function which parses it as a filename reference. Since this parameter could reference a string of an unbounded length, the directory change operation could generate an untrappable exception. This flaw could make the vulnerable utility unstable, effectively terminating the Perl interpreter abnormally, leading to the DoS condition. The following code snippet depicts where the vulnerability could have been introduced within the <code>rcmd</code> script:</p>
<pre class="nested active"><code class="language-python">chop($curdir=`cd`);
print NS &quot;$curdir&gt; &quot;;
while (&lt;NS&gt;) {
  print &quot;Client request : &quot;;
    print;
  CASE: {
      /cd / &amp;&amp; do { $dir=$'; $dir=~s/\015\012//; print $dir if $debug;
                    chdir &quot;$dir&quot; || print NS &quot;Invalid directory\015\012&quot;  ; last CASE; };
      /^(\b)*(.:)/ &amp;&amp; do { $drive=$2; ; print &quot;driver:[$drive]&quot; if $debug;
                    chdir &quot;$drive&quot; || print NS &quot;Invalid drive\015\012&quot;  ; last CASE; };
</code></pre>
<p class="nested active">An official confirmation and software updates are currently unavailable. Users are requested to avoid using the vulnerable utility until official fixes are released. For a workaround, users could consider introducing restrictive firewall policies that prohibit unnecessary access to the vulnerable script from an unauthorized source.</p>
<h3 class="h3 collapsible" onclick="toggle(this);">Vulnerability Sources</h3>
<p class="nested active"><a href="http://www.securityfocus.com/bid/51312/">bid:51312</a><br />
<a href="http://iptools.sourceforge.net/iptools.html">iptools</a>  </p>
<h3 class="h3 collapsible" onclick="toggle(this);">Generic Sources</h3>
<p class="nested active"><a href="http://cve.mitre.org">cve.mitre.org</a><br />
<a href="http://www.first.org/cvss/cvss-guide.html">cvss-guide</a><br />
<a href="http://nvd.nist.gov/cvss.cfm?calculator&amp;adv&amp;version=2">cvss-calculator</a>  </p>
  </div>

  <nav class="post-nav" style="margin-top:1em;">
    <a class="nav-prev" href="/posts/20120101_vuln-weekends-6.html"><span class="arrow">&lt;&lt;&lt;</span> <span class="nav-title">Vulnerable Weekends #6: WPS Bruteforce and CoCSoft Stream Down</span></a>    <a class="nav-next" href="/posts/20120602_vuln-weekends-8.html"><span class="nav-title">Vulnerable Weekends #8: HP LoadRunner RCE</span> <span class="arrow">&gt;&gt;&gt;</span></a>  </nav>
</article>

<script>
document.addEventListener('DOMContentLoaded', function() {
  var content = document.querySelector('.content');
  if (content) {
    var headings = content.querySelectorAll('h2,h3,h4,h5,h6');
    headings.forEach(function(h) {
      var link = document.createElement('a');
      link.href = '#top';
      link.className = 'top-link';
      link.textContent = ' [^]';
      link.style.fontSize = '0.8em';
      link.style.color = 'var(--muted)';
      h.appendChild(link);
    });
  }
});
</script>

<footer>
  <p class="nested active">cc-by-sa-4.0</p>
</footer>

<script>hljs.configure({ignoreUnescapedHTML: true}); hljs.highlightAll(); hljs.initLineNumbersOnLoad();</script>
</body>
</html>