<!DOCTYPE html>
<html lang="en" data-theme-mode="light">
<head>
  <meta charset="utf-8">
  <meta name="author" content="Ankur Tyagi (@7h3rAm)">
  <meta name="description" content="Personal Weblog">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Manthan</title>
  <link rel="icon" type="image/webp" sizes="32x32" href="/static/images/manthan-32x32.png.webp">
  <link rel="stylesheet" href="/static/css/base.css">
  <link rel="stylesheet" href="/static/css/atelier-forest-light.css">
  <script src="/static/js/theme.js"></script>
  <script src="/static/js/highlight.min.js"></script>
  <script src="/static/js/hljs-bash.min.js"></script>
  <script src="/static/js/hljs-python.min.js"></script>
  <script src="/static/js/hljs-sql.min.js"></script>
  <script src="/static/js/hljs-powershell.min.js"></script>
  <script src="/static/js/hljs-line-numbers.min.js"></script>
</head>
<body>

<header>
  <div>
    <h1 class="site-title"><a href="/" style="color:inherit;text-decoration:none;">manthan</a></h1>
    <p class="meta">security research | code | writeups</p>
  </div>
</header>

<article id="top">
  <div class="post-header">
    <div style="display:flex; justify-content:space-between; align-items:flex-start;">
      <div>
        <h1 class="post-title" style="margin:0; cursor:pointer;" onclick="toggleAllSections()">Vulnerable Weekends #4: Windows True-Type Fonts and Windows DVR-MS</h1>
      </div>
      <div class="meta" style="text-align:right;">
        <div>18/Dec/2011</div>
        <div class="tags"><a href="/tags.html#vulnweekends">vulnweekends</a></div>
      </div>
    </div>
    <nav class="post-nav" style="margin-top:0.3em;">
      <a class="nav-prev" href="/posts/20111210_vuln-weekends-3.html"><span class="arrow">&lt;&lt;&lt;</span> <span class="nav-title">Vulnerable Weekends #3: Cisco WebEx Player and ISC DHCP</span></a>      <a class="nav-next" href="/posts/20111224_vuln-weekends-5.html"><span class="nav-title">Vulnerable Weekends #5: MIT Kerberos and VLC TiVo</span> <span class="arrow">&gt;&gt;&gt;</span></a>    </nav>
  </div>

  <div class="content">
    <h2 class="h2 collapsible" onclick="toggle(this);">Introduction</h2>
<p class="nested active">Report #4A analyzes the Microsoft Windows True-Type fonts handling vulnerability that the W32.Duqu malware leverages to install itself on vulnerable systems. Once installed, it could then leverage its elevated privileges to execute arbitrary code.</p>
<p class="nested active">Report #4B analyzes the Microsoft Windows DVR-MS media files processing vulnerability that could also be leveraged to execute arbitrary code on the targeted system.</p>
<h2 class="h2 collapsible" onclick="toggle(this);">Vulnerability Report #4A: Microsoft Windows Kernel-Mode Drivers True-Type Font Handling Remote Code Execution Vulnerability</h2>
<p class="nested active"><strong>Vulnerable Product</strong>: Installations of Microsoft Windows XP, Server 2003, Vista, Server 2008, and 7</p>
<p class="nested active"><strong>CVE ID</strong>: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3402">CVE-2011-3402</a></p>
<p class="nested active"><strong>CVSS v2 Score</strong>:<br />
<strong>Access Vector</strong>: NETWORK<br />
<strong>Access Complexity</strong>: MEDIUM<br />
<strong>Authentication</strong>: NONE  </p>
<p class="nested active"><strong>Confidentiality Impact</strong>: COMPLETE<br />
<strong>Integrity Impact</strong>: COMPLETE<br />
<strong>Availability Impact</strong>: COMPLETE<br />
<strong>Base Score</strong>: 9.3  </p>
<p class="nested active"><strong>Exploitability</strong>: FUNCTIONAL<br />
<strong>Remediation Level</strong>: OFFICIAL FIX<br />
<strong>Report Confidence</strong>: CONFIRMED<br />
<strong>Temporal Score</strong>: 7.7  </p>
<h3 class="h3 collapsible" onclick="toggle(this);">Details</h3>
<p class="nested active">Microsoft Windows has been reported to contain a vulnerability that could be leveraged to execute arbitrary code on the targeted system. The vulnerability has been reported within the Kernel-Mode driver, <code>Win32k.sys</code>, that provides rendering support for True-Type fonts.</p>
<p class="nested active">The vulnerability is due to the fact that the vulnerable font processing engine fails to perform mandatory boundary checks on user-supplied input received via crafted True-Type fonts embedded within a Microsoft Office <code>.doc</code> file. An attacker who could convince a remote user to open a malicious <code>.doc</code> file, containing the specially crafted content, could exploit this vulnerability to cause a memory corruption error within kernel space. Further, the attacker could leverage such memory corruption errors to inject arbitrary shellcode within system memory and execute it with <code>SYSTEM</code> privileges on the targeted system.</p>
<p class="nested active">Public <a href="http://www.symantec.com/connect/w32-duqu_status-updates_installer-zero-day-exploit">sources</a> confirm that the <a href="http://tools.cisco.com/security/center/viewAlert.x?alertId=24425">W32.Duqu</a> malware, assumed to be a variant of <a href="http://tools.cisco.com/security/center/viewAlert.x?alertId=20915">W32/Stuxnet-B</a>, leverages this vulnerability to infect targeted systems.</p>
<p class="nested active">The vendor, Microsoft, has released a <a href="http://technet.microsoft.com/en-us/security/bulletin/MS11-087">security bulletin</a> to confirm this vulnerability and provided official patches for its mitigation. Users are requested to keep their systems updated with the latest available patches.</p>
<h3 class="h3 collapsible" onclick="toggle(this);">Vulnerability Sources</h3>
<p class="nested active"><a href="http://www.securityfocus.com/bid/50462">bid:50462</a><br />
<a href="http://tools.cisco.com/security/center/viewAlert.x?alertId=24500">cisco:24500</a><br />
<a href="http://www.symantec.com/security_response/writeup.jsp?docid=2011-101814-1119-99">symc</a>  </p>
<h2 class="h2 collapsible" onclick="toggle(this);">Vulnerability Report #4B: Microsoft Windows Media Player DVR-MS Files Processing Remote Code Execution Vulnerability</h2>
<p class="nested active"><strong>Vulnerable Product</strong>: Installations of Microsoft Windows XP, Vista, and 7</p>
<p class="nested active"><strong>CVE ID</strong>: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3401">CVE-2011-3401</a></p>
<p class="nested active"><strong>CVSS v2 Score</strong>:<br />
<strong>Access Vector</strong>: NETWORK<br />
<strong>Access Complexity</strong>: MEDIUM<br />
<strong>Authentication</strong>: NONE  </p>
<p class="nested active"><strong>Confidentiality Impact</strong>: COMPLETE<br />
<strong>Integrity Impact</strong>: COMPLETE<br />
<strong>Availability Impact</strong>: COMPLETE<br />
<strong>Base Score</strong>: 9.3  </p>
<p class="nested active"><strong>Exploitability</strong>: UNPROVEN<br />
<strong>Remediation Level</strong>: OFFICIAL FIX<br />
<strong>Report Confidence</strong>: CONFIRMED<br />
<strong>Temporal Score</strong>: 6.9  </p>
<h3 class="h3 collapsible" onclick="toggle(this);">Details</h3>
<p class="nested active">Microsoft Windows Media Player has been reported to contain a vulnerability that could be leveraged to execute arbitrary code on the targeted system. The vulnerability exists within the <code>encdec.dll</code> library used by the vulnerable platforms.</p>
<p class="nested active">The vulnerability is introduced while the affected software tries to process Microsoft Digital Video Recording (DVR-MS) media files. The affected software fails to perform sufficient security checks on user-supplied input received via such files, leading to a memory corruption error within kernel space. An attacker who could convince a targeted user to open a malicious <code>.dvr-ms</code> file, could exploit this vulnerability and leverage the memory corruption error to execute arbitrary code with <code>SYSTEM</code> privileges.</p>
<p class="nested active">The vendor, Microsoft, has released a <a href="http://technet.microsoft.com/en-us/security/bulletin/MS11-092">security bulletin</a> to confirm this vulnerability and provided official patches for its mitigation. Users are requested to keep their systems updated with the latest available patches.</p>
<h3 class="h3 collapsible" onclick="toggle(this);">Vulnerability Sources</h3>
<p class="nested active"><a href="http://www.securityfocus.com/bid/50957">bid:50957</a><br />
<a href="http://secunia.com/advisories/cve_reference/CVE-2011-3401/">secunia:cve-2011-3401</a>  </p>
<h3 class="h3 collapsible" onclick="toggle(this);">Generic Sources</h3>
<p class="nested active"><a href="http://cve.mitre.org">cve.mitre.org</a><br />
<a href="http://www.first.org/cvss/cvss-guide.html">cvss-guide</a><br />
<a href="http://nvd.nist.gov/cvss.cfm?calculator&amp;adv&amp;version=2">cvss-calculator</a>  </p>
  </div>

  <nav class="post-nav" style="margin-top:1em;">
    <a class="nav-prev" href="/posts/20111210_vuln-weekends-3.html"><span class="arrow">&lt;&lt;&lt;</span> <span class="nav-title">Vulnerable Weekends #3: Cisco WebEx Player and ISC DHCP</span></a>    <a class="nav-next" href="/posts/20111224_vuln-weekends-5.html"><span class="nav-title">Vulnerable Weekends #5: MIT Kerberos and VLC TiVo</span> <span class="arrow">&gt;&gt;&gt;</span></a>  </nav>
</article>

<script>
document.addEventListener('DOMContentLoaded', function() {
  var content = document.querySelector('.content');
  if (content) {
    var headings = content.querySelectorAll('h2,h3,h4,h5,h6');
    headings.forEach(function(h) {
      var link = document.createElement('a');
      link.href = '#top';
      link.className = 'top-link';
      link.textContent = ' [^]';
      link.style.fontSize = '0.8em';
      link.style.color = 'var(--muted)';
      h.appendChild(link);
    });
  }
});
</script>

<footer>
  <p class="nested active">cc-by-sa-4.0</p>
</footer>

<aside class="sidebar">
  <div class="sidebar-content">
    <h4 class="h4 collapsible" onclick="toggle(this);">navigation</h4>
    <a href="/">home</a>
    <a href="/archive.html">archive</a>
    <a href="/tags.html">tags</a>
    <a href="/stats.html">stats</a>
    <hr>
    <h4 class="h4 collapsible" onclick="toggle(this);">external</h4>
    <a href="https://github.com/@7h3rAm">github</a>
    <a href="https://twitter.com/@7h3rAm">twitter</a>
    <hr>
    <h4 class="h4 collapsible" onclick="toggle(this);">toggles</h4>
    <div class="toggle-group">
      <button class="toggle-btn toggle-theme" onclick="toggleThemeMode()" data-icon-on="&#xf186;" data-icon-off="&#xf185;"></button>
      <button class="toggle-btn toggle-density" onclick="toggleDensity()" data-icon-on="&#xf422;" data-icon-off="&#xf424;"></button>
      <button class="toggle-btn toggle-width" onclick="toggleWidth()" data-icon-on="&#xf337;" data-icon-off="&#xf338;"></button>
      <button class="toggle-btn toggle-justify" onclick="toggleJustify()" data-icon-on="&#xf039;" data-icon-off="&#xf036;"></button>
      <button class="toggle-btn toggle-collapse" onclick="toggleAllSections()" data-icon-on="&#xf0c9;" data-icon-off="&#xf0c9;"></button>
    </div>
  </div>
</aside>

<script>hljs.configure({ignoreUnescapedHTML: true}); hljs.highlightAll(); hljs.initLineNumbersOnLoad();</script>
</body>
</html>