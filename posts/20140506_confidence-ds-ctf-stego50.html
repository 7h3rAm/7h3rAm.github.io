<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="author" content="Ankur Tyagi (@7h3rAm)"/>
    <meta name="description" content="Personal Weblog"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>‡§Æ‡§Ç‡§•‡§® | Manthan</title>
    <link rel="icon" type="image/webp" sizes="32x32" href="/static/images/manthan-32x32.png.webp"/>
    <link rel="stylesheet" type="text/css" media="screen" href="/static/css/style.css"/>
    <link rel="stylesheet" href="/static/css/atelier-forest-light.css">
    <!-- <link rel="stylesheet" href="/static/css/atom-one-light.min.css"> -->
    <!-- <link rel="stylesheet" href="/static/css/default.min.css"> -->
    <!-- <link rel="stylesheet" href="/static/css/docco.min.css"> -->
    <!-- <link rel="stylesheet" href="/static/css/github-gist.min.css"> -->
    <!-- <link rel="stylesheet" href="/static/css/github.min.css"> -->
    <!-- <link rel="stylesheet" href="/static/css/zenburn.min.css"> -->
    <script charset="UTF-8" src="/static/js/highlight.min.js"></script>
    <script charset="UTF-8" src="/static/js/highlightjs-line-numbers.min.js"></script>
    <script charset="UTF-8" src="/static/js/go.min.js"></script>
   </head>
  <body>
    <div class="body">
      <div class="topmenu">
        <table>
          <tr>
            <td colspan="3"><a class="menu_home" href="/index.html">‡§Æ‡§Ç‡§•‡§®</a></td>
          </tr>
          <tr>
            <td><a class="menu_archive" href="/archive.html">üíæ Archive</a></td>
            <td><a class="menu_tags" href="/tags.html">üîñ Tags</a></td>
            <td><a class="menu_stats" href="/stats.html">üìä Stats</a></td>
          </tr>
        </table>
      </div>
      <div class="content">
          <hr>
  <h1 class="h1 title collapsible" onclick="toggle(this);">CONFidence DS CTF Teaser: Stegano50</h1>
    <div class="title"><code><span class="sparklines"><span style="color:#6f42c1;">‚ñÜ</span><span style="color:#6c757d;">‚ñá</span><span style="color:#00b7eb;">‚ñà</span><span style="color:#f44336;">‚ñÖ</span><span style="color:#ffcc66;">‚ñà</span><span style="color:#00bcd4;">‚ñÜ</span><span style="color:#007bff;">‚ñà</span><span style="color:#4caf50;">‚ñÉ</span><span style="color:#17a2b8;">‚ñÇ</span><span style="color:#e83e8c;">‚ñà</span><span style="color:#ffc107;">‚ñÜ</span><span style="color:#6f42c1;">‚ñÑ</span><span style="color:#6610f2;">‚ñÉ</span><span style="color:#20b2aa;">‚ñÖ</span><span style="color:#6c757d;">‚ñÅ</span><span style="color:#17a2b8;">‚ñÅ</span><span style="color:#f44336;">‚ñà</span><span style="color:#dc3545;">‚ñÖ</span><span style="color:#ffcc66;">‚ñá</span><span style="color:#6c757d;">‚ñá</span><span style="color:#69359c;">‚ñÑ</span><span style="color:#fd7e14;">‚ñá</span><span style="color:#2196f3;">‚ñÑ</span><span style="color:#2196f3;">‚ñÅ</span><span style="color:#6f42c1;">‚ñÅ</span><span style="color:#00bcd4;">‚ñÉ</span><span style="color:#5b92e5;">‚ñÅ</span><span style="color:#007bff;">‚ñÑ</span><span style="color:#00b7eb;">‚ñÜ</span><span style="color:#f44336;">‚ñá</span><span style="color:#e83e8c;">‚ñÉ</span><span style="color:#99cc99;">‚ñÅ</span><span style="color:#99cc99;">‚ñÅ</span><span style="color:#20b2aa;">‚ñÖ</span><span style="color:#00b7eb;">‚ñÜ</span><span style="color:#99cc99;">‚ñÜ</span><span style="color:#4caf50;">‚ñÑ</span><span style="color:#99cc99;">‚ñÇ</span><span style="color:#00b7eb;">‚ñÜ</span><span style="color:#e83e8c;">‚ñÜ</span><span style="color:#20b2aa;">‚ñÜ</span><span style="color:#dc3545;">‚ñÇ</span><span style="color:#69359c;">‚ñá</span><span style="color:#e83e8c;">‚ñÑ</span><span style="color:#28a745;">‚ñà</span><span style="color:#6610f2;">‚ñà</span><span style="color:#2196f3;">‚ñÅ</span><span style="color:#00b7eb;">‚ñÜ</span><span style="color:#6c757d;">‚ñá</span><span style="color:#fe4164;">‚ñÉ</span><span style="color:#4caf50;">‚ñÜ</span><span style="color:#00b7eb;">‚ñÉ</span><span style="color:#20b2aa;">‚ñÑ</span><span style="color:#007bff;">‚ñÉ</span><span style="color:#00bcd4;">‚ñÉ</span><span style="color:#6c757d;">‚ñá</span><span style="color:#5b92e5;">‚ñá</span><span style="color:#fd7e14;">‚ñÇ</span><span style="color:#6f42c1;">‚ñá</span><span style="color:#6610f2;">‚ñÑ</span><span style="color:#fe4164;">‚ñÑ</span><span style="color:#28a745;">‚ñÑ</span><span style="color:#fe4164;">‚ñá</span><span style="color:#2196f3;">‚ñÅ</span></span></code></div>
    <hr>
          <p style="float:left;"><a href="/posts/20140327_northrop-challenge.html"> ¬´ </a>üìÖ published on <code>06/May/2014</code><a href="/posts/20140618_pcapgentools-contentype-patch.html"> ¬ª </a></p>
        <p style="float:right;">üîñ tagged <a href=/tags.html#code>code</a> and <a href=/tags.html#ctf>ctf</a></p>
    <div style="clear:both;"></div>
    <hr><h2 class="h2 collapsible" onclick="toggle(this);">Challenge Analysis</h2>
<p class="nested active">The challenge consists a <a href="/static/files/posts_confidence_ds_ctf_stego50/stegano50.pdf">pdf</a> file. Let's see what <code>exiftool</code> tells us about it:</p>
<pre class="nested active"><code>$ exiftool stegano50.pdf
ExifTool Version Number         : 9.46
File Name                       : stegano50.pdf
Directory                       : .
File Size                       : 38 kB
File Modification Date/Time     : 2014:05:06 22:08:58+05:30
File Access Date/Time           : 2014:05:06 20:41:54+05:30
File Inode Change Date/Time     : 2014:05:06 13:05:07+05:30
File Permissions                : rw-rw-r--
File Type                       : PDF
MIME Type                       : application/pdf
PDF Version                     : 1.5
Linearized                      : No
Page Count                      : 1
Page Mode                       : UseOutlines
Author                          : KeiDii
Title                           : polar bear during a snow storm
Subject                         : &lt;| tr AB .- |&gt;
Creator                         : LaTeX /o/
Producer                        : find mr.morse text
Keywords                        : Could, this, be, the, flag?, :, Tm9wZSAsIG5vdCBoZXJlIDspCg==
Create Date                     : 2014:03:13 22:33:50+01:00
Modify Date                     : 2014:03:13 22:33:50+01:00
Trapped                         : False
PTEX Fullbanner                 : This is pdfTeX, Version 3.1415926-2.5-1.40.14 (TeX Live 2013/Debian) kpathsea version 6.1.1
</code></pre>
<p class="nested active">All attributes seem standard except for <code>Subject</code>, <code>Producer</code> and <code>Keywords</code>. Since the <code>Keywords</code> obviously hints at a flag like string which seems to be base64 encoded, the first thing I tried was to decode it:</p>
<pre class="nested active"><code>$ echo -n &quot;Tm9wZSAsIG5vdCBoZXJlIDspCg==&quot; | base64 -d - 
Nope , not here ;)
</code></pre>
<p class="nested active">Well, that explains. Let's focus on <code>Subject</code> and <code>Producer</code> once again. These definitely hint towards a blob of text that might need Morse code decoding. The <code>Subject</code> hints towards translating A and B to dot and dash and it obviously points to the fact that the blob of text has to be all As and Bs. Let's view the pdf in Firefox via its <a href="https://mozilla.github.io/pdf.js/">pdf.js</a> renderer:</p>
<p class="nested active"><img alt="stego50_pdfjs.png" src="/static/files/posts_confidence_ds_ctf_stego50/stego50_pdfjs.png.webp" /></p>
<p class="nested active">There it is! A <code>div</code> element has the text blob we need. Let's extract and translate it as per the hint:</p>
<pre class="nested active"><code>$ echo -n &quot;BABA BBB BA BBA ABA AB B AAB ABAA AB B AA BBB BA AAA BBAABB AABA ABAA AB BBA BBBAAA ABBBB BA AAAB ABBBB AAAAA ABBBB BAAA ABAA AAABB BB AAABB AAAAA AAAAA AAAAB BBA AAABB&quot; | tr AB .-
-.-. --- -. --. .-. .- - ..- .-.. .- - .. --- -. ... --..-- ..-. .-.. .- --. ---... .---- -. ...- .---- ..... .---- -... .-.. ...-- -- ...-- ..... ..... ....- --. ...--
</code></pre>
<hr><h2 class="h2 collapsible" onclick="toggle(this);">Automation and Testing</h2>
<p class="nested active">Alright, we now have some Morse code that has to be decoded. There are <a href="http://mattfedder.com/cgi-bin/morse.pl">several</a> <a href="http://morsecode.scphillips.com/translator.html">online</a> <a href="http://www.onlineconversion.com/morse_code.htm">decoders</a> <a href="http://www.unit-conversion.info/texttools/morse-code/">available</a>, however, I tend to use Python for such tasks. Here is a snippet of Python code to help us with encode and decode tasks:</p>
<pre class="nested active"><code class="language-python">#!/usr/bin/env python

class morse:
  def __init__(self):
    # https://en.wikipedia.org/wiki/Morse_code
    self.tocode = dict({
      'A': '.-',
      'B': '-...',
      'C': '-.-.',
      'D': '-..',
      'E': '.',
      'F': '..-.',
      'G': '--.',
      'H': '....',
      'I': '..',
      'J': '.---',
      'K': '-.-',
      'L': '.-..',
      'M': '--',
      'N': '-.',
      'O': '---',
      'P': '.--.',
      'Q': '--.-',
      'R': '.-.',
      'S': '...',
      'T': '-',
      'U': '..-',
      'V': '...-',
      'W': '.--',
      'X': '-..-',
      'Y': '-.--',
      'Z': '--..',
      '0': '-----',
      '1': '.----',
      '2': '..---',
      '3': '...--',
      '4': '....-',
      '5': '.....',
      '6': '-....',
      '7': '--...',
      '8': '---..',
      '9': '----.',
      '.': '.-.-.-',
      ',': '--..--',
      '?': '..--..',
      '\'': '.----.',
      '!': '-.-.-- ',
      '/': '-..-.',
      '(': '-.--.',
      ')': '-.--.-',
      '&amp;': '.-...',
      ':': '---...',
      ';': '-.-.-.',
      '=': '-...-',
      '+': '.-.-.',
      '-': '-....-',
      '_': '..--.-',
      '&quot;': '.-..-.',
      '$': '...-..-',
      '@': '.--.-.'
    })

    self.fromcode = dict((v,k) for (k,v) in self.tocode.items())

  def to_morse(self, d):
    i = list()
    for c in d:
      if c.upper() in self.tocode.keys():
        i.append(self.tocode[c.upper()])
      else:
        i.append(&quot; &quot;)
    return &quot; &quot;.join(i)

  def from_morse(self, d):
    i = list()
    for c in d.split(&quot; &quot;):
      if c in self.fromcode.keys():
        i.append(self.fromcode[c])
    return &quot;&quot;.join(i)
</code></pre>
<p class="nested active">Let's quickly use this script from within <code>iPython</code> and decode the Morse encoded message:</p>
<pre class="nested active"><code class="language-python">$ ipython --no-banner

&gt;&gt;&gt; import morse
&gt;&gt;&gt; morse = morse.morse()
&gt;&gt;&gt;
&gt;&gt;&gt; message = &quot;-.-. --- -. --. .-. .- - ..- .-.. .- - .. --- -. ... --..-- ..-. .-.. .- --. ---... .---- -. ...- .---- ..... .---- -... .-.. ...-- -- ...-- ..... ..... ....- --. ...--&quot;
&gt;&gt;&gt;
&gt;&gt;&gt; morse.from_morse(message)
'CONGRATULATIONS,FLAG:1NV151BL3M3554G3'
&gt;&gt;&gt;
</code></pre>
<p class="nested active">There we go!</p>
    <hr>
          <p style="float:left;">¬´ <a href="/posts/20140327_northrop-challenge.html">Northrop's Online Challenge</a> ¬´</p>
      <p style="float:right;">¬ª <a href="/posts/20140618_pcapgentools-contentype-patch.html">PCAP-GenerationTools and Conte...</a> ¬ª</p>
          </div>
      <div><a class="footer" href="https://github.com/7h3rAm/7h3rAm.github.io">Óäë Óäê Óäó</a></div>
      <script>hljs.initHighlightingOnLoad();</script>
      <script>hljs.initLineNumbersOnLoad();</script>
      <script>
        function toggle(s){
          s.classList.toggle("expanded");
          var t=!1,i=!1,a=!1;
          s.classList.contains("h2")&&(t=!0),s.classList.contains("h3")&&(i=!0),s.classList.contains("h4")&&(a=!0);
          for(var l=s.nextElementSibling;l;){
            if(t&&l.classList.contains("h2")){
              l.classList.toggle("active");
              break
            }
            if(i&&(l.classList.contains("h2")||l.classList.contains("h3"))){
              l.classList.toggle("active");
              break
            }
            if(a&&(l.classList.contains("h2")||l.classList.contains("h3")||l.classList.contains("h4"))){
              l.classList.toggle("active");
              break
            }
            l.classList.contains("collapsible")&&l.classList.toggle("expanded"),l.classList.toggle("active"),l=l.nextElementSibling
          }
        }
      </script>
    </div>
  </body>
</html>