<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="author" content="7h3rAm"/>
    <meta name="description" content="Personal Weblog"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>Grey Matter</title>

    <link href="/static/css/default.css" rel="stylesheet" type="text/css">
    <link href="/static/css/codehilite/perldoc.css" rel="stylesheet" type="text/css">

    <link href="/static/images/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png"/>
  </head>
  <body>
    <section id="content" class="body">
              <div class="header">
          <table>
            <tr>
              <td class="blogtitle"><a href="/" style="color: rgb(102, 102, 102);">Grey Matter</a></td>
              <td class="blognavbar">
                [<a id="archive" href="/archive.html" style="color: rgb(70, 130, 180);">Archive</a>] [<a id="tags" href="/tags.html" style="color: rgb(255, 183, 69);">Tags</a>] [<a id="projects" href="/projects.html" style="color: rgb(0, 128, 128);">Projects</a>] [<a id="research" href="/research.html" style="color: rgb(242, 119, 122);">Research</a>]
              </td>
            </tr>
          </table>
        </div>
                  <article class="post">
  <div class="row">
    <div class="col-lg-12">
      <div class="panel panel-default section compact">
        <div class="body">
          <p class="heading">Vulnerable Weekends #8: HP LoadRunner RCE</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <p class="date">
                  <a href="/2012/vuln-weekends-7.html">&lt&lt;</a> published on 02/Jun/2012<a href="/2012/exploit-mitigation-techniques-on-linux.html"> &gt;&gt;</i></a><br/>
                </p>
                                                                                                                                                                                                                            <div class="post-content">
          <h3>Vulnerability Report #8: HP LoadRunner magentservice.exe Component Remote Code Execution Vulnerability</h3>

<p><strong>Vulnerable Product</strong>: Installations of HP LoadRunner prior to version 11 patch 4</p>

<p><strong>CVE ID</strong>: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4789">CVE-2011-4789</a></p>

<p><strong>CVSS v2 Score</strong>:
<strong>Access Vector</strong>: REMOTE
<strong>Access Complexity</strong>: LOW
<strong>Authentication</strong>: NONE</p>

<p><strong>Confidentiality Impact</strong>: COMPLETE
<strong>Integrity Impact</strong>: COMPLETE
<strong>Availability Impact</strong>: COMPLETE
<strong>Base Score</strong>: 10</p>

<p><strong>Exploitability</strong>: FUNCTIONAL
<strong>Remediation Level</strong>: OFFICIAL FIX
<strong>Report Confidence</strong>: CONFIRMED
<strong>Temporal Score</strong>: 8.3</p>

<p><strong>Details</strong>:
HP LoadRunner is vulnerable to a remote code execution vulnerability due to insufficient boundary checks performed on user-supplied input received via its <code>magentservice.exe</code> component.</p>

<p>The vulnerability exists due to an implementation flaw within the affected software. The vulnerable component listens for incoming requests on TCP/23472 and it expects a size value within the first 32bits of user-supplied input. This value is used as-is, without any sanitization, for internal calculations that involve deriving the number of bytes to be copied in to a destination buffer. Due to the insufficient checks, a 32bit value of 0x00000000 could cause an error within the internal calculation logic and trigger a stack-based buffer overflow during a later copy operation. This action could allow a remote attacker to execute arbitrary code with <code>SYSTEM</code> privileges on the targeted system.</p>

<p>HP has confirmed this vulnerability and released a security patch for registered users.</p>

<p><strong>Vulnerability Sources</strong>:
<a href="http://www.securityfocus.com/bid/51398/">bid:51398</a>
<a href="https://h20565.www2.hp.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c03216705&amp;ac.admitted=1338640006393.876444892.492883150">hpsb:HPSBMU02785</a>
<a href="http://www.metasploit.com/modules/exploit/windows/misc/hp_magentservice">metasploit</a>
<a href="http://www.zerodayinitiative.com/advisories/ZDI-12-016/">zdi:12-016</a></p>

<p><strong>Generic Sources</strong>:
<a href="http://cve.mitre.org">cve.mitre.org</a>
<a href="http://www.first.org/cvss/cvss-guide.html">cvss-guide</a>
<a href="http://nvd.nist.gov/cvss.cfm?calculator&amp;adv&amp;version=2">cvss-calculator</a></p>

        </div>
        <div class="meta">
          <hr/>
          <p>For comments, questions and suggestions use <a href="https://twitter.com/7h3rAm" target="_blank">twitter</a> or create an <a href="https://github.com/7h3rAm/7h3rAm.github.io/issues/new" target="_blank">issue</a> on blog repository.</p>
          <hr/>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <table>
                <tr>
                  <td align="left">(share via <a href="mailto:?subject=Vulnerable Weekends #8: HP LoadRunner RCE&body=http://7h3ram.github.io//2012/vuln-weekends-8.html" target="_blank" title="Share via Email">mail</a>, <a href="http://twitter.com/intent/tweet?text=Vulnerable Weekends #8: HP LoadRunner RCE+http://7h3ram.github.io//2012/vuln-weekends-8.html&via=7h3rAm" target="_blank" title="Share on Twitter">twitter</a>, <a href="http://www.facebook.com/sharer/sharer.php?s=100&p[url]=http://7h3ram.github.io//2012/vuln-weekends-8.html&p[images][0]=&p[title]=Vulnerable Weekends #8: HP LoadRunner RCE&p[summary]=" target="_blank" title="Share on Facebook">facebook</a> or <a href="https://plus.google.com/share?url=http://7h3ram.github.io//2012/vuln-weekends-8.html" target="_blank" title="Share on Google Plus">google-plus</a>)</td>
                  <td align="right">(tagged <a href=/tags.html#vulnweekends>vulnweekends</a>)</td>
                </tr>
                <tr>
                                      <td align="left"><a href="/2012/vuln-weekends-7.html">&lt;&lt; Vulnerable Weekends #7: Iptools rcmd DoS &lt;&lt;</a></td>
                    <td align="right"><a href="/2012/exploit-mitigation-techniques-on-linux.html">&gt;&gt; Exploit Mitigation Techniques on Linux Systems &gt;&gt;</a></td>
                                  </tr>
              </table>
                                                                                                                                                                                                                </div>
        </div>
      </div>
    </div>
  </div>
  </article>
              <div class="footer">
          <center>
            <a href="/rss.xml" target="_blank">rss</a> | <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license" target="_blank">license</a>
          </center>
        </div>
          </section>

    <script type="text/javascript">
      document.addEventListener("DOMContentLoaded", function() {
        var colors = ["#4B0082", "#3CB371", "#2E8B57", "#808000", "#20B2AA", "#008B8B", "#4682B4", "#B0C4DE", "#87CEFA", "#87CEEB", "#1E90FF", "#6495ED", "#000080", "#191970"];
        document.getElementById("element").style.color = colors[Math.floor(Math.random() * colors.length)];
      }, false);
    </script>

  </body>
</html>