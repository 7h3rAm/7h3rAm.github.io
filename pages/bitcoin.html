<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="author" content="Ankur Tyagi (@7h3rAm)"/>
    <meta name="description" content="Personal Weblog"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>मंथन | Manthan</title>
    <link rel="icon" type="image/webp" sizes="32x32" href="/static/images/manthan-32x32.png.webp"/>
    <link rel="stylesheet" type="text/css" media="screen" href="/static/css/style.css"/>
    <link id="codestylesheet" rel="stylesheet" type="text/css" media="screen" href="/static/css/atelier-forest-light.css">
    <link rel="stylesheet" href="/static/css/tablesort.css"/>
    <link rel="stylesheet" href="/static/css/leaflet.css"/>
   </head>
  <body>
    <div class="body">
      <div class="menu">
        <table>
          <tr>
            <td colspan="3"><a class="menu_home" href="/index.html">मंथन</a></td>
          </tr>
          <tr>
            <td><a class="menu_archive" href="/archive.html">💾 Archive</a></td>
            <td><a class="menu_tags" href="/tags.html">🔖 Tags</a></td>
            <td><a class="menu_stats" href="/stats.html">📊 Stats</a></td>
          </tr>
        </table>
      </div>
      <div class="content">
        <h1 class="h1"><img class="btcicon" alt="₿" src="https://raw.githubusercontent.com/7h3rAm/datastore/master/Bitcoin_evergreen.png">Bitcoin</h1>
          <ul class="active">
            <li><h2 class="h2 collapsible expanded" onclick=toggle(this);>📙 Learn</h2><ul class="active nested">
              <li><a href="https://bitcoin.org/en/">Bitcoin - Open source P2P money</a></li>
              <li><a href="https://en.bitcoin.it/wiki/Main_Page">Bitcoin Wiki</a></li>
              <li><a href="https://learnmeabitcoin.com/beginners/">Beginners Guide to Bitcoin</a></li>
              <li><a href="https://bitcoiner.guide/">Bitcoiner.Guide | A collection of Bitcoin resources by BitcoinQnA</a></li>
              <li><a href="https://bitcoin-intro.com/">bitcoin-intro | start using bitcoin</a></li>
              <li><a href="https://bitcoin-only.com/">Bitcoin Only</a></li>
              <li><a href="https://bitcoin-resources.com/">Bitcoin Resources</a></li>
              <li><a href="https://www.lopp.net/bitcoin-information.html">Bitcoin Information &amp; Educational Resources</a></li>
              <li><a href="https://bitcoin.clarkmoody.com/dashboard/">Dashboard | Clark Moody Bitcoin</a></li>
              <li><a href="https://bitcoinvisuals.com/">Bitcoin Visuals - Extensive Charts and Statistics</a></li>
              <li><a href="https://endthefud.org/">End The FUD | The best links to articles debunking Bitcoin FUD</a></li>
              <li><a href="https://lightning.network/">Lightning Network</a></li>
              <li><a href="https://1ml.com/">1ML - Lightning Network Search and Analysis Engine - Bitcoin mainnet</a></li>
            </ul></li>

            <!-- <li><h2 class="h2 collapsible expanded" onclick=toggle(this);>🧮 Nodes</h2><ul class="active nested"> -->
            <!--   <li><p class="active nested"><span id="count_nodes">?</span> reachable nodes. Data provided courtesy of <a href="https://bitnodes.io/">Bitnodes</a> team.</p></li> -->
            <!--   <li><div id="nodesmap" style="width:100%; height:450px; border:1px solid;" class="mapclass"></div></li> -->
            <!-- </ul></li> -->

            <!-- <li><h2 class="h2 collapsible expanded" onclick=toggle(this);>🟧 Blocks</h2><ul class="active nested"> -->
            <!--   <li><p class="collapsible expanded"><small>Found <span id="totalblocktweetcount"></span> <a href="https://twitter.com/hashtag/BlockTweets">#BlockTweets</a> in <a href="https://twitter.com/hashtag/Timechain">#Timechain</a>/<a href="https://twitter.com/hashtag/Tweetchain">#Tweetchain</a></small></p> -->
            <!--   <li><h3 class="h3 collapsible expanded" onclick=toggle(this);>Latest Block Stats Image</h3><ul class="active nested"><li><img src="https://raw.githubusercontent.com/7h3rAm/datastore/master/latestblock.png"></li></ul></li> -->
            <!--   <li><h3 class="h3 collapsible expanded" onclick=toggle(this);>Block Height - Tweet Mapping</h3><ul class="active nested"> -->
            <!--     <li><table id="blockstable" class="active nested astrotabclass"></table></li> -->
            <!--   </ul></li> -->
            <!-- </ul></li> -->

            <li><h2 class="h2 collapsible expanded" onclick=toggle(this);><a id="wallets"></a>💼 Wallets</h2><ul class="active nested">
              <li><h3 class="h3 collapsible expanded" onclick=toggle(this);>📄 Summary</h3><ul class="active nested">
                <li>Bitcoin blockchain is an open ledger and all activity since the genesis block is readily available for review. Bitcoin ledger is also pseudo-anonymous since addresses owned by an entity are not known (unless this relationship is already public or exposed via other means).</li>
                <li>Since each entity can own and use multiple addresses, a wallet and name is used as an abstration is used to refer to these address groups.</li>
                <li>The following sections list stats for certain entities that are grouped as:
                  <ul>
                    <li>Donation: These entities have publicly shared their addresses for charity/donations</li>
                    <li>Popular: These entities are popular and their address ownership details are publicly available</li>
                    <li>Ransom: These are malicious entities using Bitcoin blockchain for ransom or extortion purposes</li>
                  </ul>
                </li>
                <li><table id="statstable" class="active nested astrotabclass">
                  <thead><tr>
                    <th>Category</th>
                    <th>Wallets</th>
                    <th>Addresses</th>
                    <th>Received</th>
                    <th>Sent</th>
                    <th>Balance</th>
                  </tr></thead>
                  <tbody><tr>
                    <td><a href="#donation">🙏 Donation</a></td>
                    <td id="count_wallet_donation"></td>
                    <td id="count_address_donation"></td>
                    <td id="count_received_donation"></td>
                    <td id="count_sent_donation"></td>
                    <td id="count_balance_donation"></td>
                  </tr>
                  <tr>
                    <td><a href="#popular">🔥 Popular</td>
                    <td id="count_wallet_popular"></td>
                    <td id="count_address_popular"></td>
                    <td id="count_received_popular"></td>
                    <td id="count_sent_popular"></td>
                    <td id="count_balance_popular"></td>
                  </tr>
                  <tr>
                    <td><a href="#ransom">👾 Ransom</td>
                    <td id="count_wallet_ransom"></td>
                    <td id="count_address_ransom"></td>
                    <td id="count_received_ransom"></td>
                    <td id="count_sent_ransom"></td>
                    <td id="count_balance_ransom"></td>
                  </tr>
                  <tr data-sort-method="none">
                    <td><a href="#ransom"><b>💼 Total</b></td>
                    <td id="count_wallet"></td>
                    <td id="count_address"></td>
                    <td id="count_received"></td>
                    <td id="count_sent"></td>
                    <td id="count_balance"></td>
                  </tr></tbody>
                </table></li>
              </ul></li>
              <li><h3 class="h3 collapsible expanded" onclick=toggle(this);>🗿 Graph</h3><ul class="active nested">
                <li><div id="walletgraph" class="svgcontainer">
                  <div id="option">
                    <input name="expandall" type="button" value="ExpandAll" onclick="expandAll()"/>
                    <input name="collapseall" type="button" value="CollapseAll" onclick="collapseAll()"/>
                  </div>
                </div></li>
              </ul></li>
              <li><h3 class="h3 collapsible expanded" onclick=toggle(this);><a id="donation"></a>🙏 Donation</h3><ul class="active nested">
                <li><table id="donationtable" class="active nested astrotabclass"></table></li>
              </ul></li>
              <li><h3 class="h3 collapsible expanded" onclick=toggle(this);><a id="popular"></a>🔥 Popular</h3><ul class="active nested">
                <li><table id="populartable" class="active nested astrotabclass"></table></li>
              </ul></li>
              <li><h3 class="h3 collapsible expanded" onclick=toggle(this);><a id="ransom"></a>👾 Ransom</h3><ul class="active nested">
                <li><table id="ransomtable" class="active nested astrotabclass"></table></li>
              </ul></li>
            </ul></li>
          </ul>
          <p style="float:right;"><code id="lastupdate"></code></p>

      <script type="text/javascript" src="/static/js/timeago.min.js"></script>
      <script type="text/javascript" src="/static/js/tablesort.min.js"></script>
      <script type="text/javascript" src="/static/js/tablesort.monthname.js"></script>
      <script type="text/javascript" src="/static/js/tablesort.number.js"></script>
      <script type="text/javascript" src="/static/js/numeral.min.js"></script>
      <script type="text/javascript" src="/static/js/leaflet.js"></script>
      <script type="text/javascript" src="/static/js/leaflet.terminator.js"></script>
      <script type="text/javascript" src="/static/js/d3.v4.js"></script>
      <script type="text/javascript">
        numeral.zeroFormat('0');
        numeral.nullFormat('0');

        // https://stackoverflow.com/a/17177423/1079836
        function truncateWithEllipses(text, max) {return text.substr(0,max-1)+(text.length>max?'...':''); }

        function loadJson(url, callback) {
          var XmlHttpRequest = new XMLHttpRequest();
          XmlHttpRequest.overrideMimeType("application/json");
          XmlHttpRequest.open('GET', url, true);
          XmlHttpRequest.onreadystatechange = function () {
            if (XmlHttpRequest.readyState == 4 && XmlHttpRequest.status == "200") {
              callback(XmlHttpRequest.responseText);
            }
          }
          XmlHttpRequest.send(null);
        }

        function addBTC2USDHover(priceusd, node, value, format="0,0a", color="#f7931a", isbtc=false, fontbold=false) {
          format = format? format : "0,0a";
          color = color? color : "#f7931a";
          var btcicon = document.createElement("img");
          btcicon.setAttribute("src", "https://raw.githubusercontent.com/7h3rAm/datastore/master/Bitcoin_evergreen.png");
          btcicon.setAttribute("class", "btciconsmall");
          btcicon.setAttribute("alt", "₿");
          var link = document.createElement("a");
          if (isbtc) {
            link.title = numeral(value*priceusd).format('$0,0a');
            link.text = numeral(value).format(format);
          } else {
            if (Math.abs(value) <= 9) {
              link.title = numeral((value/Math.pow(10, 8))*priceusd).format('$0,0a');
              link.text = (value/Math.pow(10, 8)).toFixed(8);
            } else {
              link.title = numeral((value/Math.pow(10, 8))*priceusd).format('$0,0a');
              link.text = Math.abs(value) > 0 ? numeral(value/Math.pow(10, 8)).format(format) : "0.00000000";
            }
          }
          link.style.color = color;
          if (typeof node === "string") {
            document.getElementById(node).appendChild(btcicon);
            document.getElementById(node).appendChild(link);
          } else {
            node.appendChild(btcicon);
            node.appendChild(link);
          }
          if (fontbold) {
            link.style.fontWeight = "bold";
          }
        }

        var root,
            margin,
            width,
            height,
            svg;
        var i = 0,
            duration = 750,
            nodeHeight = 20,
            treeData,
            treemap;
        function responsivefy(svg) {
          // https://brendansudol.com/writing/responsive-d3
          var container = d3.select(svg.node().parentNode),
            width = parseInt(svg.style("width")),
            height = parseInt(svg.style("height")),
            aspect = width / height;
          svg.attr("viewBox", "0 0 " + width + " " + height)
            .attr("perserveAspectRatio", "xMinYMid")
            .call(resize);
          d3.select(window).on("resize." + container.attr("id"), resize);
          function resize() {
            var targetWidth = parseInt(container.style("width"));
            svg.attr("width", targetWidth);
            svg.attr("height", Math.round(targetWidth / aspect));
          }
        }
        function collapse(d) {
          if(d.children) {
            d._children = d.children
            d._children.forEach(collapse)
            d.children = null
          }
        }
        function expand(d) {
          if (d._children) {
            d.children = d._children;
            d._children = null;
          }
          var children = (d.children) ? d.children: d._children;
          if (children) {
            children.forEach(expand);
          }
        }
        function countLeaves(obj) {
          var leaves = 0;
          recursiveCounter(obj);
          function recursiveCounter(obj) {
            if (obj.children) {
              for (var i = 0; i < obj.children.length; i++) {
                if (obj.children[i].children) {
                  recursiveCounter(obj.children[i]);
                } else {
                  leaves++;
                };
              };
            };
          }
          return leaves;
        }
        function expandAll() {
          expand(root);
          update(root);
        }
        function collapseAll() {
          root.children.forEach(collapse);
          update(root);
        }
        function walletgraph() {
          margin = {top: 30, right: 90, bottom: 30, left: 90};
          width = 960 - margin.left - margin.right;
          height = 540 - margin.top - margin.bottom;
          svg = d3.select("#walletgraph").append("svg")
              .attr("width", width + margin.right + margin.left)
              .attr("height", height + margin.top + margin.bottom)
              .call(responsivefy)
              .call(d3.zoom().on("zoom", function () {
                svg.attr("transform", d3.event.transform)
              }))
              .append("g")
              .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
          treeData = bitcoin.graph.grouped;
          root = d3.hierarchy(treeData, function(d) { return d.children; });
          var numberOfLeaves = countLeaves(root);
          var oldHeight = height;
          height = (nodeHeight * numberOfLeaves);
          console.log("for " + numberOfLeaves + " leaf nodes, changed height from " + oldHeight + " to " + height);
          //root.children.forEach(collapse);
          root.x0 = height / 2;
          root.y0 = 0;
          treemap = d3.tree().size([height, width]);
          update(root, height, width, svg);
        }

        function update(source) {
          treemap = d3.tree().size([height, width]);
          var treeData = treemap(root);
          var nodes = treeData.descendants(), links = treeData.descendants().slice(1);
          nodes.forEach(function(d){ d.y = d.depth * 180});
          var node = svg.selectAll('g.node').data(nodes, function(d) {return d.id || (d.id = ++i); });
          var nodeEnter = node.enter().append('g').attr('class', 'node').attr("transform", function(d) {
            return "translate(" + source.y0 + "," + source.x0 + ")";
          }).on('click', click);
          nodeEnter.append("circle").attr("r", function(d) { return d.data.size; }).style("stroke", function(d) { return d.data.nodecolor; }).style("fill", function(d) { return d.data.fillcolor; }).append("svg:title").text(function(d, i) { return d.data.tooltip; });

          nodeEnter.append('text').attr("y", function(d) { return d.children || d._children ? 0 : -6; }).attr("dy", ".35em").attr("x", function(d) {
            return d.children || d._children ? d.data.size*-1-5 : d.data.size+5;
          }).attr("text-anchor", function(d) {
            return d.children || d._children ? "end" : "start";
          }).text(function(d) { return d.data.outlabel; });
          //nodeEnter.append('text').attr("y", function(d) { return d.children || d._children ? 0 : 6; }).attr("dy", ".35em").attr("x", function(d) {
          //  return d.children || d._children ? d.data.size*-1-5 : d.data.size+5;
          //}).attr("text-anchor", function(d) { return d.children || d._children ? "end" : "start"; }).text(function(d) {
          //  return d.children || d._children ? "" : "LastActivity: " + d.data.lastactivity;
          //}).style("font-size", "7pt");
          nodeEnter.append('text').attr("y", function(d) { return d.children || d._children ? 0 : -6; }).attr("dy", ".35em").attr("x", function(d) {
            return d.children || d._children ? d.data.size*-1-5-((d.data.outlabel.length+1)*9) : d.data.size+5+((d.data.outlabel.length+1)*9);
          }).attr("text-anchor", function(d) { return d.children || d._children ? "end" : "start"; }).text(function(d) {
            return d.children || d._children ? "" : "(LastActivity: " + d.data.lastactivity + ")";
          }).style("font-size", "7pt");

          nodeEnter.append("text").attr("y", function(d) { return d.children || d._children ? 0 : 0; }).attr("dy", ".35em").attr("text-anchor", "middle").style("fill-opacity", 1).text(function(d) {     return d.data.inlabel; }).style("font-size", "9pt");
          var nodeUpdate = nodeEnter.merge(node);
          nodeUpdate.transition().duration(duration).attr("transform", function(d) {
            return "translate(" + d.y + "," + d.x + ")";
          });
          nodeUpdate.select('circle.node').attr('r', 10).attr('cursor', 'pointer');
          var nodeExit = node.exit().transition().duration(duration).attr("transform", function(d) {
            return "translate(" + source.y + "," + source.x + ")";
          }).remove();
          nodeExit.select('circle').attr('r', 1e-6);
          nodeExit.select('text').style('fill-opacity', 1e-6);
          var link = svg.selectAll('path.link').data(links, function(d) { return d.id; });
          var linkEnter = link.enter().insert('path', "g").attr("class", "link").style("stroke", function(d) { return d.data.edgecolor; }).attr('d', function(d) {
            var o = { x: source.x0, y: source.y0 }
            return diagonal(o, o)
          });
          var linkUpdate = linkEnter.merge(link);
          linkUpdate.transition().duration(duration).attr('d', function(d) { return diagonal(d, d.parent) });
          var linkExit = link.exit().transition().duration(duration).attr('d', function(d) {
            var o = { x: source.x, y: source.y }
            return diagonal(o, o)
          }).remove();
          nodes.forEach(function(d) {
            d.x0 = d.x;
            d.y0 = d.y;
          });
          function diagonal(s, d) {
            path = `M ${s.y} ${s.x}
                    C ${(s.y + d.y) / 2} ${s.x},
                      ${(s.y + d.y) / 2} ${d.x},
                      ${d.y} ${d.x}`
            return path
          }
          function click(d) {
            if (d.children) {
              d._children = d.children;
              d.children = null;
            } else {
              d.children = d._children;
              d._children = null;
            }
            update(d);
          }
        }

        function bitnodes() {
          document.getElementById("count_nodes").innerText = bitcoin["stats"]["count_nodes"];
          maxi = 1000;
          if (bitcoin["nodes"].length) {
            var bounds = L.latLngBounds()
            var nodesmap = L.map('nodesmap').setView([0, 0], 2);
            var osmlayer = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
            console.log(osmlayer);
            L.tileLayer(osmlayer, {
              attribution: '<a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
            }).addTo(nodesmap);
            const size = 15;
            const btcico = L.icon({iconUrl: "https://raw.githubusercontent.com/7h3rAm/datastore/master/Bitcoin_evergreen.png", iconSize: [size, size]})
            const markerOptions = { draggable: false, icon: btcico }
            var tor = 0; var clearnet = 0;
            for (var i = 0; i < bitcoin["nodes"].length; i++) {
              if (bitcoin["nodes"][i]["latitude"] === "Unknown" || bitcoin["nodes"][i]["longitude"] === "Unknown" || bitcoin["nodes"][i]["hostname"] === "Unknown") {
                continue;
              } else {
                clearnet += 1;
                marker = new L.marker([bitcoin["nodes"][i]["latitude"], bitcoin["nodes"][i]["longitude"]], markerOptions);
                var text = '<a href="https://bitnodes.io/nodes/"><b>' + bitcoin["nodes"][i]["ipurl"] + "</b></a><br/><b>UserAgent</b>: " + bitcoin["nodes"][i]["useragent"] + " (" + bitcoin["nodes"][i]["protoversion"] + ")" + "<br/><b>Height</b>: " + bitcoin["nodes"][i]["height"] + "<br/><b>Connected</b>: " + bitcoin["nodes"][i]["connectedsincehuman"] + " (" + timeago.format(bitcoin["nodes"][i]["connectedsince"]*1000) + ")";
                marker.bindPopup(text).addTo(nodesmap);
                bounds.extend([bitcoin["nodes"][i]["latitude"], bitcoin["nodes"][i]["longitude"]]);
              }
              if (clearnet >= maxi) { break; }
            }
            const opt = {
              color: '#000',
              opacity: 0.1,
              fillColor: '#000',
              fillOpacity: 0.3,
              resolution: 2
            };
            const t = L.terminator(opt);
            t.addTo(nodesmap);
            const updateTerminator = function(t) {
              let t2 = L.terminator(opt);
              t.setLatLngs(t2.getLatLngs());
              t.redraw();
            };
            L.control.scale().addTo(nodesmap);
            nodesmap.fitBounds(bounds)
          }
        }

        function add_category_table(category, categorynode) {
          var thead = document.createElement("thead");
          var tr = document.createElement("tr");
          //var th = document.createElement("th"); var text = document.createTextNode("#"); th.appendChild(text); th.style.fontWeight = "bold"; tr.appendChild(th);
          var th = document.createElement("th"); var text = document.createTextNode("VisSum"); th.appendChild(text); th.style.fontWeight = "bold"; tr.appendChild(th);
          var th = document.createElement("th"); var text = document.createTextNode("Wallet"); th.appendChild(text); th.style.fontWeight = "bold"; tr.appendChild(th);
          //var th = document.createElement("th"); var text = document.createTextNode("Funds"); th.appendChild(text); th.style.fontWeight = "bold"; tr.appendChild(th);
          var th = document.createElement("th"); var text = document.createTextNode("Received"); th.appendChild(text); th.style.fontWeight = "bold"; tr.appendChild(th);
          var th = document.createElement("th"); var text = document.createTextNode("Sent"); th.appendChild(text); th.style.fontWeight = "bold"; tr.appendChild(th);
          var th = document.createElement("th"); var text = document.createTextNode("Balance"); th.appendChild(text); th.style.fontWeight = "bold"; tr.appendChild(th);
          var th = document.createElement("th"); var text = document.createTextNode("LastActivity"); th.appendChild(text); th.style.fontWeight = "bold"; tr.appendChild(th);
          thead.appendChild(tr);
          categorynode.appendChild(thead);
          var tbody = document.createElement("tbody");
          var i = 0;
          Object.keys(bitcoin["category"][category]).forEach(function(wallet) {
            if (bitcoin["category"][category][wallet]["txcount"] > 0) {
              var tr = document.createElement("tr");
              //var td = document.createElement("td");
              //var text = document.createTextNode(i+1 + ".");
              //td.appendChild(text);
              //tr.appendChild(td);
              var td = document.createElement("td");
              var span = document.createElement("span")
              span.setAttribute("class", "sparklines");
              var text = document.createTextNode(bitcoin["category"][category][wallet]["sparkid"]);
              span.appendChild(text);
              colorspark(span);
              td.appendChild(span);
              tr.appendChild(td);
              var td = document.createElement("td");
              var link = document.createElement("a");
              var text = document.createTextNode(truncateWithEllipses(wallet, 60));
              link.appendChild(text);
              var addr = bitcoin["category"][category][wallet]["addresses"].length > 1 ? "addresses" : "address";
              var txs = bitcoin["category"][category][wallet]["txcount"] > 1 ? "transactions" : "transaction";
              link.title = "'" + wallet + "' wallet has " + bitcoin["category"][category][wallet]["addresses"].length + " " + addr + " with " + numeral(bitcoin["category"][category][wallet]["txcount"]).format('0,0a') + " " + txs + ".";
              td.appendChild(link);
              tr.appendChild(td);
              //var td = document.createElement("td");
              //td.setAttribute("data-sort", bitcoin["category"][category][wallet]["balance"]);
              //addBTC2USDHover(priceusd, td, bitcoin["category"][category][wallet]["received"], '0.00000000', "#5cb25e", isbtc=false); var para = document.createElement("p"); td.append(para);
              //addBTC2USDHover(priceusd, td, bitcoin["category"][category][wallet]["sent"], '0.00000000', "#fc580c", isbtc=false); var para = document.createElement("p"); td.append(para);
              //addBTC2USDHover(priceusd, td, isNaN(numeral(bitcoin["category"][category][wallet]["balance"]).format('0'))? 0 : bitcoin["category"][category][wallet]["balance"], '0.00000000', "#5b92e5", isbtc=false); var para = document.createElement("p"); td.append(para);
              //tr.appendChild(td);
              var td = document.createElement("td");
              td.setAttribute("data-sort", bitcoin["category"][category][wallet]["received"]);
              addBTC2USDHover(priceusd, td, bitcoin["category"][category][wallet]["received"], '0.00000000', "#5cb25e", isbtc=false);
              tr.appendChild(td);
              var td = document.createElement("td");
              td.setAttribute("data-sort", bitcoin["category"][category][wallet]["sent"]);
              addBTC2USDHover(priceusd, td, bitcoin["category"][category][wallet]["sent"], '0.00000000', "#fc580c", isbtc=false);
              tr.appendChild(td);
              var td = document.createElement("td");
              td.setAttribute("data-sort", bitcoin["category"][category][wallet]["balance"]);
              addBTC2USDHover(priceusd, td, isNaN(numeral(bitcoin["category"][category][wallet]["balance"]).format('0'))? 0 : bitcoin["category"][category][wallet]["balance"], '0.00000000', "#5b92e5", isbtc=false);
              tr.appendChild(td);
              var td = document.createElement("td");
              if (bitcoin["category"][category][wallet]["lasttx"]["epoch"]) {
                var summary = document.createElement("span");
                if (bitcoin["category"][category][wallet]["lasttx"]["summary"] > 0) {
                  addBTC2USDHover(priceusd, summary, bitcoin["category"][category][wallet]["lasttx"]["summary"], '0.00000000', "#5cb25e", isbtc=false);
                } else if (bitcoin["category"][category][wallet]["lasttx"]["summary"] < 0) {
                  addBTC2USDHover(priceusd, summary, bitcoin["category"][category][wallet]["lasttx"]["summary"], '0.00000000', "#fc580c", isbtc=false);
                } else {
                  addBTC2USDHover(priceusd, summary, bitcoin["category"][category][wallet]["lasttx"]["summary"], '0.00000000', "#5b92e5", isbtc=false);
                }
                td.appendChild(summary);
                td.setAttribute("data-sort", bitcoin["category"][category][wallet]["lasttx"]["epoch"]);
                var para = document.createElement("p"); td.append(para);
                var link = document.createElement("a");
                link.title = bitcoin["category"][category][wallet]["lasttx"]["epochhuman"];
                link.text = "🔗 " + timeago.format(bitcoin["category"][category][wallet]["lasttx"]["epoch"]*1000);
                link.href = "https://mempool.space/tx/" + bitcoin["category"][category][wallet]["lasttx"]["hash"];
                td.appendChild(link);
              } else {
                var text = document.createTextNode("");
                td.setAttribute("data-sort", 0);
                td.appendChild(text);
              }
              tr.appendChild(td);
              tbody.appendChild(tr);
              i = i+1;
            }
            categorynode.appendChild(tbody);
          })
        }

        function blocks() {
          var blockstable = document.getElementById("blockstable");
          var thead = document.createElement("thead");
          var tr = document.createElement("tr");
          var th = document.createElement("th"); var text = document.createTextNode("Height"); th.appendChild(text); th.style.fontWeight = "bold"; tr.appendChild(th); th.setAttribute("data-sort-default", "");
          var th = document.createElement("th"); var text = document.createTextNode("Tweet"); th.appendChild(text); th.style.fontWeight = "bold"; tr.appendChild(th);
          thead.appendChild(tr);
          blockstable.appendChild(thead);
          var tbody = document.createElement("tbody");
          var i = 0;
          Object.keys(blocktweetidmap).forEach(function(blockheight) {
            var tr = document.createElement("tr");
            var td = document.createElement("td");
            td.setAttribute("data-sort", blockheight);
            var para = document.createElement("p"); td.append(para);
            var link = document.createElement("a");
            link.title = "Block#" + blockheight;
            link.text = "Block#" + blockheight;
            link.href = "https://learnmeabitcoin.com/explorer/blockchain/" + blockheight;
            td.appendChild(link);
            tr.appendChild(td);
            var td = document.createElement("td");
            td.setAttribute("data-sort", blocktweetidmap[blockheight]);
            var para = document.createElement("p"); td.append(para);
            var link = document.createElement("a");
            link.title = "Tweet#" + blocktweetidmap[blockheight];
            link.text = "Tweet#" + blocktweetidmap[blockheight];
            link.href = "https://twitter.com/twitter/statuses/" + blocktweetidmap[blockheight];
            td.appendChild(link);
            tr.appendChild(td);
            tr.appendChild(td);
            tbody.appendChild(tr);
            i = i+1;
            blockstable.appendChild(tbody);
          })
          var blockstablesort = new Tablesort(blockstable,{descending:true});
          blockstablesort.refresh();
          var totalblocktweetcount = document.getElementById("totalblocktweetcount");
          totalblocktweetcount.innerText = i;
        }

        function wallets() {
          document.getElementById("count_wallet").style.fontWeight = "bold";
          document.getElementById("count_address").style.fontWeight = "bold";
          document.getElementById("count_wallet").innerText = bitcoin["stats"]["count_wallet"];
          document.getElementById("count_address").innerText = bitcoin["stats"]["count_address"];
          addBTC2USDHover(priceusd, "count_received", bitcoin["stats"]["count_received"], '0,0a', "#5cb25e", isbtc=false, fontbold=true);
          addBTC2USDHover(priceusd, "count_sent", bitcoin["stats"]["count_sent"], '0,0a', "#fc580c", isbtc=false, fontbold=true);
          addBTC2USDHover(priceusd, "count_balance", bitcoin["stats"]["count_balance"], '0,0a', "#5b92e5", isbtc=false, fontbold=true);

          document.getElementById("count_wallet_donation").innerText = bitcoin["stats"]["donation"]["count_wallet"];
          document.getElementById("count_address_donation").innerText = bitcoin["stats"]["donation"]["count_address"];
          addBTC2USDHover(priceusd, "count_received_donation", bitcoin["stats"]["donation"]["count_received"], '0,0a', "#5cb25e", isbtc=false);
          addBTC2USDHover(priceusd, "count_sent_donation", bitcoin["stats"]["donation"]["count_sent"], '0,0a', "#fc580c", isbtc=false);
          addBTC2USDHover(priceusd, "count_balance_donation", bitcoin["stats"]["donation"]["count_balance"], '0,0a', "#5b92e5", isbtc=false);

          document.getElementById("count_wallet_popular").innerText = bitcoin["stats"]["popular"]["count_wallet"];
          document.getElementById("count_address_popular").innerText = bitcoin["stats"]["popular"]["count_address"];
          addBTC2USDHover(priceusd, "count_received_popular", bitcoin["stats"]["popular"]["count_received"], '0,0a', "#5cb25e", isbtc=false);
          addBTC2USDHover(priceusd, "count_sent_popular", bitcoin["stats"]["popular"]["count_sent"], '0,0a', "#fc580c", isbtc=false);
          addBTC2USDHover(priceusd, "count_balance_popular", bitcoin["stats"]["popular"]["count_balance"], '0,0a', "#5b92e5", isbtc=false);

          document.getElementById("count_wallet_ransom").innerText = bitcoin["stats"]["ransom"]["count_wallet"];
          document.getElementById("count_address_ransom").innerText = bitcoin["stats"]["ransom"]["count_address"];
          addBTC2USDHover(priceusd, "count_received_ransom", bitcoin["stats"]["ransom"]["count_received"], '0,0a', "#5cb25e", isbtc=false);
          addBTC2USDHover(priceusd, "count_sent_ransom", bitcoin["stats"]["ransom"]["count_sent"], '0,0a', "#fc580c", isbtc=false);
          addBTC2USDHover(priceusd, "count_balance_ransom", bitcoin["stats"]["ransom"]["count_balance"], '0,0a', "#5b92e5", isbtc=false);

          var donationtable = document.getElementById("donationtable"); add_category_table("donation", donationtable);
          var populartable = document.getElementById("populartable"); add_category_table("popular", populartable);
          var ransomtable = document.getElementById("ransomtable"); add_category_table("ransom", ransomtable);
          var statstable = document.getElementById("statstable");
          var statssort = new Tablesort(statstable);
          statssort.refresh();
          var donationtable = document.getElementById("donationtable");
          var donationsort = new Tablesort(donationtable);
          donationsort.refresh();
          var populartable = document.getElementById("populartable");
          var popularsort = new Tablesort(populartable);
          popularsort.refresh();
          var ransomtable = document.getElementById("ransomtable");
          var ransomsort = new Tablesort(ransomtable);
          ransomsort.refresh();
        }

        function doBlockchainStats() {
          loadJson("https://api.coinbase.com/v2/prices/spot?currency=USD", function(response) {
            spotpriceapi = JSON.parse(response);
            console.log("https://api.coinbase.com/v2/prices/spot?currency=USD");
            console.log(spotpriceapi);
            priceusd = spotpriceapi["data"]["amount"];

            //loadJson("https://raw.githubusercontent.com/7h3rAm/datastore/master/blocktweetidmap.json", function(response) {
            //  blocktweetidmap = JSON.parse(response);
            //  console.log("https://raw.githubusercontent.com/7h3rAm/datastore/master/blocktweetidmap.json");
            //  console.log(blocktweetidmap);
            //  blocks();

              loadJson("https://raw.githubusercontent.com/7h3rAm/datastore/master/bitcoin.json", function(response) {
                bitcoin = JSON.parse(response);
                console.log("https://raw.githubusercontent.com/7h3rAm/datastore/master/bitcoin.json");
                console.log(bitcoin);
                //bitnodes();
                walletgraph();
                wallets();
                document.getElementById("lastupdate").innerText = "Last Update: " + bitcoin["last_update"] + " (" + timeago.format(bitcoin["last_update_epoch"]*1000) + ")";
              });

            //});

          });
        }

        // https://stackoverflow.com/a/54248600/1079836
        function colorspark(element) {
          var colors = ["#007bff", "#00bcd4", "#17a2b8", "#20c997", "#2196f3", "#28a745", "#4caf50", "#6610f2", "#6c757d", "#6f42c1", "#8357ff", "#dc3545", "#e83e8c", "#f44336", "#fd7e14", "#ffc107", "#20b2aa", "#99cc99", "#0c9", "#5b92e5", "#ffcc66", "#00b7eb", "#69359c", "#fe4164", "#a50b5e"];
          var text = element.innerText;
          element.innerText = '';
          var chars = text.split('');
          for(var ch of chars) {
             var charspan = document.createElement('span');
             charspan.innerText = ch;
             var index = Math.floor(Math.random()*colors.length);
             charspan.style.color = colors[index]
             element.appendChild(charspan);
          }
        }

        window.onload = () => {
          //setInterval(() => {doTime();},1000); // every .5s
          doBlockchainStats();
        }
      </script>

      </div>
      <script>
        function toggle(s){
          s.classList.toggle("expanded");
          var t=!1,i=!1,a=!1;
          s.classList.contains("h2")&&(t=!0),s.classList.contains("h3")&&(i=!0),s.classList.contains("h3")&&(a=!0);
          for(var l=s.nextElementSibling;l;){
            if (t&&l.classList.contains("h2")){
              l.classList.toggle("active");
              break
            }
            if (i&&(l.classList.contains("h2")||l.classList.contains("h3"))){
              l.classList.toggle("active");
              break
            }
            if (a&&(l.classList.contains("h2")||l.classList.contains("h3")||l.classList.contains("h3"))){
              l.classList.toggle("active");
              break
            }
            l.classList.contains("collapsible")&&l.classList.toggle("expanded"),l.classList.toggle("active"),l=l.nextElementSibling
          }
        }
      </script>
      <script type="text/javascript">
        const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
        const currentTheme = localStorage.getItem('theme') ? localStorage.getItem('theme') : null;
        if (currentTheme) {
          document.documentElement.setAttribute('data-theme', currentTheme);
          if (currentTheme === 'dark') {
            toggleSwitch.checked = true;
            document.documentElement.setAttribute('data-theme', 'dark');
            localStorage.setItem('theme', 'dark');
          } else {
            toggleSwitch.checked = false;
            document.documentElement.setAttribute('data-theme', 'light');
            localStorage.setItem('theme', 'light');
          }
          console.log("pageload: theme:" + currentTheme + " switch:" + toggleSwitch.checked);
        }
        function switchTheme(e) {
          if (e.target.checked) {
            document.documentElement.setAttribute('data-theme', 'dark');
            localStorage.setItem('theme', 'dark');
          } else {
            document.documentElement.setAttribute('data-theme', 'light');
            localStorage.setItem('theme', 'light');
          }    
          const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
          const currentTheme = localStorage.getItem('theme') ? localStorage.getItem('theme') : null;
          console.log("pageload: theme:" + currentTheme + " switch:" + toggleSwitch.checked);
        }
        toggleSwitch.addEventListener('change', switchTheme, false);
      </script>
      </div>
      <div><a class="footer" href="https://github.com/7h3rAm/7h3rAm.github.io">  </a></div>
    </div>
  </body>
</html>
