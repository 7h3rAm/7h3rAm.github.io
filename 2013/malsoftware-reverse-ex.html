<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="author" content="7h3rAm"/>
    <meta name="description" content="Personal Weblog"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>Grey Matter</title>

    <link href="/static/css/default.css" rel="stylesheet" type="text/css">
    <link href="/static/css/codehilite/perldoc.css" rel="stylesheet" type="text/css">

    <link href="/static/images/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png"/>
  </head>
  <body>
    <section id="content" class="body">
              <div class="header">
          <table>
            <tr>
              <td class="blogtitle"><a href="/" style="color: rgb(102, 102, 102);">Grey Matter</a></td>
              <td class="blognavbar">
                <a href="/archive.html">[Archive]</a> <a href="/tags.html">[Tags]</a> <a href="/projects.html">[Projects]</a> <a href="/research.html">[Research]</a>
              </td>
            </tr>
          </table>
        </div>
                  <article class="post">
  <div class="row">
    <div class="col-lg-12">
      <div class="panel panel-default section compact">
        <div class="body">
          <p class="heading">reverse-ex Challenge from Coursera's Malicious Software Course</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <p class="date">
                  <a href="/2013/libnids-pynids.html">&lt&lt;</a> published on 24/Aug/2013<a href="/2013/malsoftware-reverse-challenge.html"> &gt;&gt;</i></a><br/>
                </p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <div class="post-content">
          <p>The recently concluded <a href="https://class.coursera.org/malsoftware-001/">Malicious Software and its Undergound
Economy</a> course on
<a href="https://www.coursera.org/">Coursera</a> had an interesting reverse
engineering challenge as part of its coursework:
<a href="/static/files/reverse-ex">reverse-ex</a>. I found it interesting since it will be
equally entertaining for someone who has never tried such challenges or
one who has mastered many of them. This post details the steps I took to
complete this challenge.</p>

<p>The first thing I normally do after obtaining such challenges is to test
them with <code>file</code> command. This provides some insight about various file
attributes like its type (ELF, PE, etc.), processor architecture
compatibility, symbol table inclusion, etc:</p>

<div class="codehilite"><pre><span></span><code>$ file reverse-ex
reverse-ex: ELF <span class="m">32</span>-bit LSB executable, Intel <span class="m">80386</span>, version <span class="m">1</span> <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked <span class="o">(</span>uses shared libs<span class="o">)</span>, <span class="k">for</span> GNU/Linux <span class="m">2</span>.6.24, BuildID<span class="o">[</span> sha1<span class="o">]=</span>0x8dac70a14b40f115fc4a27041a3ae29227a55afb, not stripped
$
$ file -i reverse-ex
reverse-ex: application/x-executable<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>binary
</code></pre></div>

<p>The above output tells us that this is a 32bit
<a href="http://en.wikipedia.org/wiki/Executable_and_Linkable_Format">ELF</a>
binary, <a href="http://stackoverflow.com/questions/1993390/static-linking-vs-dynamic-linking">dynamically
linked</a>,
and has <a href="http://unix.stackexchange.com/questions/2969/what-are-stripped-and-not-stripped-executables-in-unix">symbols
included</a>.
This means that debugging and symbol resolution information has been
preserved and packed inside the binary itself. This is a very important
piece of information as it tells us that a successful disassembly of
this binary will expose functions/variable that were used in its source,
providing some pointers on how to solve this challenge. Before we move
towards disassembly, let&#8217;s run <code>strings</code> over this file as well:</p>

<p>Now this output is even more interesting since it exposes quite
significant details about the challenge. First, it didn&#8217;t show any
commonly used buffer overflow prone libc functions like <code>gets</code> or
<code>strcpy</code>, but just <code>puts</code>, <code>printf</code>, <code>read</code>, etc. There could be a
<a href="http://en.wikipedia.org/wiki/Uncontrolled_format_string">format-string</a>
issue in the program (<code>printf</code>-family functions are likely
<a href="https://security.web.cern.ch/security/recommendations/en/codetools/c.shtml">vulnerable</a>
if incorrectly used) but that can only be confirmed during static
analysis of program disassembly or via dynamic analysis with multiple
format-string prone inputs. But there&#8217;s a bigger hint here: strings at
the bottom following function names look interesting. Especially the
<code>KFFSE_XHKYOKXOHOFEDM^E_Y</code> string since it looks like some kind of a
key. May be the program mutates user-supplied input and performs a
comparison with static flags like this string. If it does, we need to
look at its disassembly and figure out the logic behind the mutation
function and try to reverse it. Let&#8217;s use <code>objdump</code> to disassemble this
binary and dump its disassembly in <a href="http://en.wikipedia.org/wiki/X86_assembly_language#Syntax">Intel
syntax</a>:</p>

<div class="codehilite"><pre><span></span><code><span class="err">$</span> <span class="n">objdump</span> <span class="o">-</span><span class="n">d</span> <span class="o">-</span><span class="n">M</span> <span class="n">intel</span> <span class="n">reverse</span><span class="o">-</span><span class="n">ex</span>

<span class="nl">reverse-ex</span><span class="p">:</span>     file format <span class="s">elf32-i386</span>

Disassembly of section <span class="nl">.text</span><span class="p">:</span>

<span class="mh">080484c4</span> <span class="p">&lt;</span><span class="nf">checkkey</span><span class="p">&gt;:</span>
 <span class="mi">80484</span><span class="nl">c4</span><span class="p">:</span> <span class="mi">55</span>                    <span class="n">push</span>   <span class="n">ebp</span>
 <span class="mi">80484</span><span class="nl">c5</span><span class="p">:</span> <span class="mi">89</span> <span class="n">e5</span>                 <span class="n">mov</span>    <span class="n">ebp</span><span class="p">,</span><span class="n">esp</span>
 <span class="mi">80484</span><span class="nl">c7</span><span class="p">:</span> <span class="mi">57</span>                    <span class="n">push</span>   <span class="n">edi</span>
 <span class="mi">80484</span><span class="nl">c8</span><span class="p">:</span> <span class="mi">56</span>                    <span class="n">push</span>   <span class="n">esi</span>
 <span class="mi">80484</span><span class="nl">c9</span><span class="p">:</span> <span class="mi">83</span> <span class="n">ec</span> <span class="mi">10</span>              <span class="n">sub</span>    <span class="n">esp</span><span class="p">,</span><span class="mh">0x10</span>
 <span class="mi">80484</span><span class="nl">cc</span><span class="p">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">45</span> <span class="mi">08</span>              <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">+</span><span class="mh">0x8</span><span class="p">]</span>
 <span class="mi">80484</span><span class="nl">cf</span><span class="p">:</span> <span class="mi">89</span> <span class="mi">45</span> <span class="n">f4</span>              <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">-</span><span class="mh">0xc</span><span class="p">],</span><span class="n">eax</span>
 <span class="mi">80484</span><span class="nl">d2</span><span class="p">:</span> <span class="n">eb</span> <span class="mi">14</span>                 <span class="n">jmp</span>    <span class="mf">80484e8</span> <span class="o">&lt;</span><span class="n">checkkey</span><span class="o">+</span><span class="mh">0x24</span><span class="o">&gt;</span>
 <span class="mi">80484</span><span class="nl">d4</span><span class="p">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">45</span> <span class="n">f4</span>              <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">-</span><span class="mh">0xc</span><span class="p">]</span>
 <span class="mi">80484</span><span class="nl">d7</span><span class="p">:</span> <span class="mf">0f</span> <span class="n">b6</span> <span class="mo">00</span>              <span class="n">movzx</span>  <span class="n">eax</span><span class="p">,</span><span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">eax</span><span class="p">]</span>
 <span class="mi">80484</span><span class="nl">da</span><span class="p">:</span> <span class="mi">89</span> <span class="n">c2</span>                 <span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="n">eax</span>
 <span class="mi">80484</span><span class="nl">dc</span><span class="p">:</span> <span class="mi">83</span> <span class="n">f2</span> <span class="mi">2</span><span class="n">a</span>              <span class="n">xor</span>    <span class="n">edx</span><span class="p">,</span><span class="mh">0x2a</span>
 <span class="mi">80484</span><span class="nl">df</span><span class="p">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">45</span> <span class="n">f4</span>              <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">-</span><span class="mh">0xc</span><span class="p">]</span>
 <span class="mf">80484e2</span><span class="o">:</span> <span class="mi">88</span> <span class="mi">10</span>                 <span class="n">mov</span>    <span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">eax</span><span class="p">],</span><span class="n">dl</span>
 <span class="mf">80484e4</span><span class="o">:</span> <span class="mi">83</span> <span class="mi">45</span> <span class="n">f4</span> <span class="mo">01</span>           <span class="n">add</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">-</span><span class="mh">0xc</span><span class="p">],</span><span class="mh">0x1</span>
 <span class="mf">80484e8</span><span class="o">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">45</span> <span class="n">f4</span>              <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">-</span><span class="mh">0xc</span><span class="p">]</span>
 <span class="mi">80484</span><span class="nl">eb</span><span class="p">:</span> <span class="mf">0f</span> <span class="n">b6</span> <span class="mo">00</span>              <span class="n">movzx</span>  <span class="n">eax</span><span class="p">,</span><span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">eax</span><span class="p">]</span>
 <span class="mi">80484</span><span class="nl">ee</span><span class="p">:</span> <span class="mi">84</span> <span class="n">c0</span>                 <span class="n">test</span>   <span class="n">al</span><span class="p">,</span><span class="n">al</span>
 <span class="mf">80484f</span><span class="mi">0</span><span class="o">:</span> <span class="mi">75</span> <span class="n">e2</span>                 <span class="n">jne</span>    <span class="mi">80484</span><span class="n">d4</span> <span class="o">&lt;</span><span class="n">checkkey</span><span class="o">+</span><span class="mh">0x10</span><span class="o">&gt;</span>
 <span class="mf">80484f</span><span class="mi">2</span><span class="o">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">45</span> <span class="mi">08</span>              <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">+</span><span class="mh">0x8</span><span class="p">]</span>
 <span class="mf">80484f</span><span class="mi">5</span><span class="o">:</span> <span class="mi">89</span> <span class="n">c2</span>                 <span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="n">eax</span>
 <span class="mf">80484f</span><span class="mi">7</span><span class="o">:</span> <span class="n">b8</span> <span class="mi">70</span> <span class="mi">87</span> <span class="mo">04</span> <span class="mi">08</span>        <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x8048770</span>
 <span class="mf">80484f</span><span class="nl">c</span><span class="p">:</span> <span class="n">b9</span> <span class="mi">19</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span>        <span class="n">mov</span>    <span class="n">ecx</span><span class="p">,</span><span class="mh">0x19</span>
 <span class="mi">8048501</span><span class="o">:</span> <span class="mi">89</span> <span class="n">d6</span>                 <span class="n">mov</span>    <span class="n">esi</span><span class="p">,</span><span class="n">edx</span>
 <span class="mi">8048503</span><span class="o">:</span> <span class="mi">89</span> <span class="n">c7</span>                 <span class="n">mov</span>    <span class="n">edi</span><span class="p">,</span><span class="n">eax</span>
 <span class="mi">8048505</span><span class="o">:</span> <span class="n">f3</span> <span class="n">a6</span>                 <span class="n">repz</span> <span class="n">cmps</span> <span class="n">BYTE</span> <span class="n">PTR</span> <span class="nl">ds</span><span class="p">:[</span><span class="n">esi</span><span class="p">],</span><span class="n">BYTE</span> <span class="n">PTR</span> <span class="nl">es</span><span class="p">:[</span><span class="n">edi</span><span class="p">]</span>
 <span class="mi">8048507</span><span class="o">:</span> <span class="mf">0f</span> <span class="mi">97</span> <span class="n">c2</span>              <span class="n">seta</span>   <span class="n">dl</span>
 <span class="mi">804850</span><span class="nl">a</span><span class="p">:</span> <span class="mf">0f</span> <span class="mi">92</span> <span class="n">c0</span>              <span class="n">setb</span>   <span class="n">al</span>
 <span class="mi">804850</span><span class="nl">d</span><span class="p">:</span> <span class="mi">89</span> <span class="n">d1</span>                 <span class="n">mov</span>    <span class="n">ecx</span><span class="p">,</span><span class="n">edx</span>
 <span class="mf">804850f</span><span class="o">:</span> <span class="mi">28</span> <span class="n">c1</span>                 <span class="n">sub</span>    <span class="n">cl</span><span class="p">,</span><span class="n">al</span>
 <span class="mi">8048511</span><span class="o">:</span> <span class="mi">89</span> <span class="n">c8</span>                 <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">ecx</span>
 <span class="mi">8048513</span><span class="o">:</span> <span class="mf">0f</span> <span class="n">be</span> <span class="n">c0</span>              <span class="n">movsx</span>  <span class="n">eax</span><span class="p">,</span><span class="n">al</span>
 <span class="mi">8048516</span><span class="o">:</span> <span class="mi">85</span> <span class="n">c0</span>                 <span class="n">test</span>   <span class="n">eax</span><span class="p">,</span><span class="n">eax</span>
 <span class="mi">8048518</span><span class="o">:</span> <span class="mi">75</span> <span class="mo">07</span>                 <span class="n">jne</span>    <span class="mi">8048521</span> <span class="o">&lt;</span><span class="n">checkkey</span><span class="o">+</span><span class="mh">0x5d</span><span class="o">&gt;</span>
 <span class="mi">804851</span><span class="nl">a</span><span class="p">:</span> <span class="n">b8</span> <span class="mo">01</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span>        <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x1</span>
 <span class="mf">804851f</span><span class="o">:</span> <span class="n">eb</span> <span class="mo">05</span>                 <span class="n">jmp</span>    <span class="mi">8048526</span> <span class="o">&lt;</span><span class="n">checkkey</span><span class="o">+</span><span class="mh">0x62</span><span class="o">&gt;</span>
 <span class="mi">8048521</span><span class="o">:</span> <span class="n">b8</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span>        <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
 <span class="mi">8048526</span><span class="o">:</span> <span class="mi">83</span> <span class="n">c4</span> <span class="mi">10</span>              <span class="n">add</span>    <span class="n">esp</span><span class="p">,</span><span class="mh">0x10</span>
 <span class="mi">8048529</span><span class="o">:</span> <span class="mi">5</span><span class="n">e</span>                    <span class="n">pop</span>    <span class="n">esi</span>
 <span class="mi">804852</span><span class="nl">a</span><span class="p">:</span> <span class="mf">5f</span>                    <span class="n">pop</span>    <span class="n">edi</span>
 <span class="mi">804852</span><span class="nl">b</span><span class="p">:</span> <span class="mi">5</span><span class="n">d</span>                    <span class="n">pop</span>    <span class="n">ebp</span>
 <span class="mi">804852</span><span class="nl">c</span><span class="p">:</span> <span class="n">c3</span>                    <span class="n">ret</span>

<span class="mh">0804852d</span> <span class="p">&lt;</span><span class="nf">foo</span><span class="p">&gt;:</span>
 <span class="mi">804852</span><span class="nl">d</span><span class="p">:</span> <span class="mi">55</span>                    <span class="n">push</span>   <span class="n">ebp</span>
 <span class="mi">804852</span><span class="nl">e</span><span class="p">:</span> <span class="mi">89</span> <span class="n">e5</span>                 <span class="n">mov</span>    <span class="n">ebp</span><span class="p">,</span><span class="n">esp</span>
 <span class="mi">8048530</span><span class="o">:</span> <span class="mi">83</span> <span class="n">ec</span> <span class="mi">18</span>              <span class="n">sub</span>    <span class="n">esp</span><span class="p">,</span><span class="mh">0x18</span>
 <span class="mi">8048533</span><span class="o">:</span> <span class="n">c7</span> <span class="mo">04</span> <span class="mi">24</span> <span class="mi">89</span> <span class="mi">87</span> <span class="mo">04</span> <span class="mi">08</span>  <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="p">],</span><span class="mh">0x8048789</span>
 <span class="mi">804853</span><span class="nl">a</span><span class="p">:</span> <span class="n">e8</span> <span class="mi">91</span> <span class="n">fe</span> <span class="n">ff</span> <span class="n">ff</span>        <span class="n">call</span>   <span class="mi">80483</span><span class="n">d0</span> <span class="o">&lt;</span><span class="n">puts</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
 <span class="mf">804853f</span><span class="o">:</span> <span class="n">b8</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span>        <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
 <span class="mi">8048544</span><span class="o">:</span> <span class="n">c9</span>                    <span class="n">leave</span>
 <span class="mi">8048545</span><span class="o">:</span> <span class="n">c3</span>                    <span class="n">ret</span>

<span class="mh">08048546</span> <span class="p">&lt;</span><span class="nf">bar</span><span class="p">&gt;:</span>
 <span class="mi">8048546</span><span class="o">:</span> <span class="mi">55</span>                    <span class="n">push</span>   <span class="n">ebp</span>
 <span class="mi">8048547</span><span class="o">:</span> <span class="mi">89</span> <span class="n">e5</span>                 <span class="n">mov</span>    <span class="n">ebp</span><span class="p">,</span><span class="n">esp</span>
 <span class="mi">8048549</span><span class="o">:</span> <span class="mi">83</span> <span class="n">ec</span> <span class="mi">18</span>              <span class="n">sub</span>    <span class="n">esp</span><span class="p">,</span><span class="mh">0x18</span>
 <span class="mi">804854</span><span class="nl">c</span><span class="p">:</span> <span class="n">c7</span> <span class="mo">04</span> <span class="mi">24</span> <span class="mi">8</span><span class="n">d</span> <span class="mi">87</span> <span class="mo">04</span> <span class="mi">08</span>  <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="p">],</span><span class="mh">0x804878d</span>
 <span class="mi">8048553</span><span class="o">:</span> <span class="n">e8</span> <span class="mi">78</span> <span class="n">fe</span> <span class="n">ff</span> <span class="n">ff</span>        <span class="n">call</span>   <span class="mi">80483</span><span class="n">d0</span> <span class="o">&lt;</span><span class="n">puts</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
 <span class="mi">8048558</span><span class="o">:</span> <span class="n">b8</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span>        <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
 <span class="mi">804855</span><span class="nl">d</span><span class="p">:</span> <span class="n">c9</span>                    <span class="n">leave</span>
 <span class="mi">804855</span><span class="nl">e</span><span class="p">:</span> <span class="n">c3</span>                    <span class="n">ret</span>

<span class="mh">0804855f</span> <span class="p">&lt;</span><span class="nf">foobar</span><span class="p">&gt;:</span>
 <span class="mf">804855f</span><span class="o">:</span> <span class="mi">55</span>                    <span class="n">push</span>   <span class="n">ebp</span>
 <span class="mi">8048560</span><span class="o">:</span> <span class="mi">89</span> <span class="n">e5</span>                 <span class="n">mov</span>    <span class="n">ebp</span><span class="p">,</span><span class="n">esp</span>
 <span class="mi">8048562</span><span class="o">:</span> <span class="mi">83</span> <span class="n">ec</span> <span class="mi">18</span>              <span class="n">sub</span>    <span class="n">esp</span><span class="p">,</span><span class="mh">0x18</span>
 <span class="mi">8048565</span><span class="o">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">45</span> <span class="mi">08</span>              <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">+</span><span class="mh">0x8</span><span class="p">]</span>
 <span class="mi">8048568</span><span class="o">:</span> <span class="mi">89</span> <span class="mo">04</span> <span class="mi">24</span>              <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="p">],</span><span class="n">eax</span>
 <span class="mi">804856</span><span class="nl">b</span><span class="p">:</span> <span class="n">e8</span> <span class="n">bd</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span>        <span class="n">call</span>   <span class="mi">804852</span><span class="n">d</span> <span class="o">&lt;</span><span class="n">foo</span><span class="o">&gt;</span>
 <span class="mi">8048570</span><span class="o">:</span> <span class="n">b8</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span>        <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
 <span class="mi">8048575</span><span class="o">:</span> <span class="n">c9</span>                    <span class="n">leave</span>
 <span class="mi">8048576</span><span class="o">:</span> <span class="n">c3</span>                    <span class="n">ret</span>

<span class="mh">08048577</span> <span class="p">&lt;</span><span class="nf">main</span><span class="p">&gt;:</span>
 <span class="mi">8048577</span><span class="o">:</span> <span class="mi">55</span>                    <span class="n">push</span>   <span class="n">ebp</span>
 <span class="mi">8048578</span><span class="o">:</span> <span class="mi">89</span> <span class="n">e5</span>                 <span class="n">mov</span>    <span class="n">ebp</span><span class="p">,</span><span class="n">esp</span>
 <span class="mi">804857</span><span class="nl">a</span><span class="p">:</span> <span class="mi">57</span>                    <span class="n">push</span>   <span class="n">edi</span>
 <span class="mi">804857</span><span class="nl">b</span><span class="p">:</span> <span class="mi">83</span> <span class="n">e4</span> <span class="n">f0</span>              <span class="n">and</span>    <span class="n">esp</span><span class="p">,</span><span class="mh">0xfffffff0</span>
 <span class="mi">804857</span><span class="nl">e</span><span class="p">:</span> <span class="mi">81</span> <span class="n">ec</span> <span class="mi">30</span> <span class="mo">02</span> <span class="mo">00</span> <span class="mo">00</span>     <span class="n">sub</span>    <span class="n">esp</span><span class="p">,</span><span class="mh">0x230</span>
 <span class="mi">8048584</span><span class="o">:</span> <span class="n">b8</span> <span class="mi">91</span> <span class="mi">87</span> <span class="mo">04</span> <span class="mi">08</span>        <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x8048791</span>
 <span class="mi">8048589</span><span class="o">:</span> <span class="mi">89</span> <span class="mo">04</span> <span class="mi">24</span>              <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="p">],</span><span class="n">eax</span>
 <span class="mi">804858</span><span class="nl">c</span><span class="p">:</span> <span class="n">e8</span> <span class="mf">1f</span> <span class="n">fe</span> <span class="n">ff</span> <span class="n">ff</span>        <span class="n">call</span>   <span class="mi">80483</span><span class="n">b0</span> <span class="o">&lt;</span><span class="n">printf</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
 <span class="mi">8048591</span><span class="o">:</span> <span class="n">a1</span> <span class="mi">40</span> <span class="n">a0</span> <span class="mo">04</span> <span class="mi">08</span>        <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="nl">ds</span><span class="p">:</span><span class="mh">0x804a040</span>
 <span class="mi">8048596</span><span class="o">:</span> <span class="mi">89</span> <span class="mo">04</span> <span class="mi">24</span>              <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="p">],</span><span class="n">eax</span>
 <span class="mi">8048599</span><span class="o">:</span> <span class="n">e8</span> <span class="mi">22</span> <span class="n">fe</span> <span class="n">ff</span> <span class="n">ff</span>        <span class="n">call</span>   <span class="mi">80483</span><span class="n">c0</span> <span class="o">&lt;</span><span class="n">fflush</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
 <span class="mi">804859</span><span class="nl">e</span><span class="p">:</span> <span class="n">c7</span> <span class="mi">44</span> <span class="mi">24</span> <span class="mi">08</span> <span class="n">ff</span> <span class="mo">01</span> <span class="mo">00</span>  <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x8</span><span class="p">],</span><span class="mh">0x1ff</span>
 <span class="mi">80485</span><span class="nl">a5</span><span class="p">:</span> <span class="mo">00</span>
 <span class="mi">80485</span><span class="nl">a6</span><span class="p">:</span> <span class="mi">8</span><span class="n">d</span> <span class="mi">44</span> <span class="mi">24</span> <span class="mi">24</span>           <span class="n">lea</span>    <span class="n">eax</span><span class="p">,[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x24</span><span class="p">]</span>
 <span class="mi">80485</span><span class="nl">aa</span><span class="p">:</span> <span class="mi">89</span> <span class="mi">44</span> <span class="mi">24</span> <span class="mo">04</span>           <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x4</span><span class="p">],</span><span class="n">eax</span>
 <span class="mi">80485</span><span class="nl">ae</span><span class="p">:</span> <span class="n">c7</span> <span class="mo">04</span> <span class="mi">24</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="p">],</span><span class="mh">0x0</span>
 <span class="mi">80485</span><span class="nl">b5</span><span class="p">:</span> <span class="n">e8</span> <span class="n">e6</span> <span class="n">fd</span> <span class="n">ff</span> <span class="n">ff</span>        <span class="n">call</span>   <span class="mi">80483</span><span class="n">a0</span> <span class="o">&lt;</span><span class="n">read</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
 <span class="mi">80485</span><span class="nl">ba</span><span class="p">:</span> <span class="mi">8</span><span class="n">d</span> <span class="mi">44</span> <span class="mi">24</span> <span class="mi">24</span>           <span class="n">lea</span>    <span class="n">eax</span><span class="p">,[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x24</span><span class="p">]</span>
 <span class="mi">80485</span><span class="nl">be</span><span class="p">:</span> <span class="n">c7</span> <span class="mi">44</span> <span class="mi">24</span> <span class="mi">1</span><span class="n">c</span> <span class="n">ff</span> <span class="n">ff</span> <span class="n">ff</span>  <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x1c</span><span class="p">],</span><span class="mh">0xffffffff</span>
 <span class="mi">80485</span><span class="nl">c5</span><span class="p">:</span> <span class="n">ff</span>
 <span class="mi">80485</span><span class="nl">c6</span><span class="p">:</span> <span class="mi">89</span> <span class="n">c2</span>                 <span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="n">eax</span>
 <span class="mi">80485</span><span class="nl">c8</span><span class="p">:</span> <span class="n">b8</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span>        <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
 <span class="mi">80485</span><span class="nl">cd</span><span class="p">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">4</span><span class="n">c</span> <span class="mi">24</span> <span class="mi">1</span><span class="n">c</span>           <span class="n">mov</span>    <span class="n">ecx</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x1c</span><span class="p">]</span>
 <span class="mi">80485</span><span class="nl">d1</span><span class="p">:</span> <span class="mi">89</span> <span class="n">d7</span>                 <span class="n">mov</span>    <span class="n">edi</span><span class="p">,</span><span class="n">edx</span>
 <span class="mi">80485</span><span class="nl">d3</span><span class="p">:</span> <span class="n">f2</span> <span class="n">ae</span>                 <span class="n">repnz</span> <span class="n">scas</span> <span class="n">al</span><span class="p">,</span><span class="n">BYTE</span> <span class="n">PTR</span> <span class="nl">es</span><span class="p">:[</span><span class="n">edi</span><span class="p">]</span>
 <span class="mi">80485</span><span class="nl">d5</span><span class="p">:</span> <span class="mi">89</span> <span class="n">c8</span>                 <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">ecx</span>
 <span class="mi">80485</span><span class="nl">d7</span><span class="p">:</span> <span class="n">f7</span> <span class="n">d0</span>                 <span class="n">not</span>    <span class="n">eax</span>
 <span class="mi">80485</span><span class="nl">d9</span><span class="p">:</span> <span class="mi">83</span> <span class="n">e8</span> <span class="mo">01</span>              <span class="n">sub</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x1</span>
 <span class="mi">80485</span><span class="nl">dc</span><span class="p">:</span> <span class="mi">89</span> <span class="mi">84</span> <span class="mi">24</span> <span class="mi">28</span> <span class="mo">02</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x228</span><span class="p">],</span><span class="n">eax</span>
 <span class="mf">80485e3</span><span class="o">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">84</span> <span class="mi">24</span> <span class="mi">28</span> <span class="mo">02</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x228</span><span class="p">]</span>
 <span class="mi">80485</span><span class="nl">ea</span><span class="p">:</span> <span class="mi">83</span> <span class="n">e8</span> <span class="mo">01</span>              <span class="n">sub</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x1</span>
 <span class="mi">80485</span><span class="nl">ed</span><span class="p">:</span> <span class="mf">0f</span> <span class="n">b6</span> <span class="mi">44</span> <span class="mo">04</span> <span class="mi">24</span>        <span class="n">movzx</span>  <span class="n">eax</span><span class="p">,</span><span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="n">eax</span><span class="o">*</span><span class="mi">1</span><span class="o">+</span><span class="mh">0x24</span><span class="p">]</span>
 <span class="mf">80485f</span><span class="mi">2</span><span class="o">:</span> <span class="mi">3</span><span class="n">c</span> <span class="mi">0</span><span class="n">a</span>                 <span class="n">cmp</span>    <span class="n">al</span><span class="p">,</span><span class="mh">0xa</span>
 <span class="mf">80485f</span><span class="mi">4</span><span class="o">:</span> <span class="mi">75</span> <span class="mf">0f</span>                 <span class="n">jne</span>    <span class="mi">8048605</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mh">0x8e</span><span class="o">&gt;</span>
 <span class="mf">80485f</span><span class="mi">6</span><span class="o">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">84</span> <span class="mi">24</span> <span class="mi">28</span> <span class="mo">02</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x228</span><span class="p">]</span>
 <span class="mf">80485f</span><span class="nl">d</span><span class="p">:</span> <span class="mi">83</span> <span class="n">e8</span> <span class="mo">01</span>              <span class="n">sub</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x1</span>
 <span class="mi">8048600</span><span class="o">:</span> <span class="n">c6</span> <span class="mi">44</span> <span class="mo">04</span> <span class="mi">24</span> <span class="mo">00</span>        <span class="n">mov</span>    <span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="n">eax</span><span class="o">*</span><span class="mi">1</span><span class="o">+</span><span class="mh">0x24</span><span class="p">],</span><span class="mh">0x0</span>
 <span class="mi">8048605</span><span class="o">:</span> <span class="mf">0f</span> <span class="n">b6</span> <span class="mi">44</span> <span class="mi">24</span> <span class="mi">24</span>        <span class="n">movzx</span>  <span class="n">eax</span><span class="p">,</span><span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x24</span><span class="p">]</span>
 <span class="mi">804860</span><span class="nl">a</span><span class="p">:</span> <span class="mf">0f</span> <span class="n">be</span> <span class="n">c0</span>              <span class="n">movsx</span>  <span class="n">eax</span><span class="p">,</span><span class="n">al</span>
 <span class="mi">804860</span><span class="nl">d</span><span class="p">:</span> <span class="mi">83</span> <span class="n">f8</span> <span class="mi">42</span>              <span class="n">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x42</span>
 <span class="mi">8048610</span><span class="o">:</span> <span class="mi">74</span> <span class="mi">17</span>                 <span class="n">je</span>     <span class="mi">8048629</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mh">0xb2</span><span class="o">&gt;</span>
 <span class="mi">8048612</span><span class="o">:</span> <span class="mi">83</span> <span class="n">f8</span> <span class="mi">43</span>              <span class="n">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x43</span>
 <span class="mi">8048615</span><span class="o">:</span> <span class="mi">74</span> <span class="mf">1f</span>                 <span class="n">je</span>     <span class="mi">8048636</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mh">0xbf</span><span class="o">&gt;</span>
 <span class="mi">8048617</span><span class="o">:</span> <span class="mi">83</span> <span class="n">f8</span> <span class="mi">41</span>              <span class="n">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x41</span>
 <span class="mi">804861</span><span class="nl">a</span><span class="p">:</span> <span class="mi">75</span> <span class="mi">27</span>                 <span class="n">jne</span>    <span class="mi">8048643</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mh">0xcc</span><span class="o">&gt;</span>
 <span class="mi">804861</span><span class="nl">c</span><span class="p">:</span> <span class="n">c7</span> <span class="mi">84</span> <span class="mi">24</span> <span class="mi">2</span><span class="n">c</span> <span class="mo">02</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x22c</span><span class="p">],</span><span class="mh">0x804852d</span>
 <span class="mi">8048623</span><span class="o">:</span> <span class="mi">2</span><span class="n">d</span> <span class="mi">85</span> <span class="mo">04</span> <span class="mi">08</span>
 <span class="mi">8048627</span><span class="o">:</span> <span class="n">eb</span> <span class="mi">1</span><span class="n">c</span>                 <span class="n">jmp</span>    <span class="mi">8048645</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mh">0xce</span><span class="o">&gt;</span>
 <span class="mi">8048629</span><span class="o">:</span> <span class="n">c7</span> <span class="mi">84</span> <span class="mi">24</span> <span class="mi">2</span><span class="n">c</span> <span class="mo">02</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x22c</span><span class="p">],</span><span class="mh">0x80484c4</span>
 <span class="mi">8048630</span><span class="o">:</span> <span class="n">c4</span> <span class="mi">84</span> <span class="mo">04</span> <span class="mi">08</span>
 <span class="mi">8048634</span><span class="o">:</span> <span class="n">eb</span> <span class="mf">0f</span>                 <span class="n">jmp</span>    <span class="mi">8048645</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mh">0xce</span><span class="o">&gt;</span>
 <span class="mi">8048636</span><span class="o">:</span> <span class="n">c7</span> <span class="mi">84</span> <span class="mi">24</span> <span class="mi">2</span><span class="n">c</span> <span class="mo">02</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x22c</span><span class="p">],</span><span class="mh">0x804855f</span>
 <span class="mi">804863</span><span class="nl">d</span><span class="p">:</span> <span class="mf">5f</span> <span class="mi">85</span> <span class="mo">04</span> <span class="mi">08</span>
 <span class="mi">8048641</span><span class="o">:</span> <span class="n">eb</span> <span class="mo">02</span>                 <span class="n">jmp</span>    <span class="mi">8048645</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mh">0xce</span><span class="o">&gt;</span>
 <span class="mi">8048643</span><span class="o">:</span> <span class="n">eb</span> <span class="n">fe</span>                 <span class="n">jmp</span>    <span class="mi">8048643</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mh">0xcc</span><span class="o">&gt;</span>
 <span class="mi">8048645</span><span class="o">:</span> <span class="mi">8</span><span class="n">d</span> <span class="mi">44</span> <span class="mi">24</span> <span class="mi">24</span>           <span class="n">lea</span>    <span class="n">eax</span><span class="p">,[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x24</span><span class="p">]</span>
 <span class="mi">8048649</span><span class="o">:</span> <span class="mi">83</span> <span class="n">c0</span> <span class="mo">01</span>              <span class="n">add</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x1</span>
 <span class="mi">804864</span><span class="nl">c</span><span class="p">:</span> <span class="mi">89</span> <span class="mo">04</span> <span class="mi">24</span>              <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="p">],</span><span class="n">eax</span>
 <span class="mf">804864f</span><span class="o">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">84</span> <span class="mi">24</span> <span class="mi">2</span><span class="n">c</span> <span class="mo">02</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x22c</span><span class="p">]</span>
 <span class="mi">8048656</span><span class="o">:</span> <span class="n">ff</span> <span class="n">d0</span>                 <span class="n">call</span>   <span class="n">eax</span>
 <span class="mi">8048658</span><span class="o">:</span> <span class="mi">89</span> <span class="mi">84</span> <span class="mi">24</span> <span class="mi">24</span> <span class="mo">02</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x224</span><span class="p">],</span><span class="n">eax</span>
 <span class="mf">804865f</span><span class="o">:</span> <span class="mi">83</span> <span class="n">bc</span> <span class="mi">24</span> <span class="mi">24</span> <span class="mo">02</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="n">cmp</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x224</span><span class="p">],</span><span class="mh">0x0</span>
 <span class="mi">8048666</span><span class="o">:</span> <span class="mo">00</span>
 <span class="mi">8048667</span><span class="o">:</span> <span class="mi">74</span> <span class="mi">1</span><span class="n">a</span>                 <span class="n">je</span>     <span class="mi">8048683</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mh">0x10c</span><span class="o">&gt;</span>
 <span class="mi">8048669</span><span class="o">:</span> <span class="n">b8</span> <span class="n">af</span> <span class="mi">87</span> <span class="mo">04</span> <span class="mi">08</span>        <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x80487af</span>
 <span class="mi">804866</span><span class="nl">e</span><span class="p">:</span> <span class="mi">8</span><span class="n">d</span> <span class="mi">54</span> <span class="mi">24</span> <span class="mi">24</span>           <span class="n">lea</span>    <span class="n">edx</span><span class="p">,[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x24</span><span class="p">]</span>
 <span class="mi">8048672</span><span class="o">:</span> <span class="mi">83</span> <span class="n">c2</span> <span class="mo">01</span>              <span class="n">add</span>    <span class="n">edx</span><span class="p">,</span><span class="mh">0x1</span>
 <span class="mi">8048675</span><span class="o">:</span> <span class="mi">89</span> <span class="mi">54</span> <span class="mi">24</span> <span class="mo">04</span>           <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x4</span><span class="p">],</span><span class="n">edx</span>
 <span class="mi">8048679</span><span class="o">:</span> <span class="mi">89</span> <span class="mo">04</span> <span class="mi">24</span>              <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="p">],</span><span class="n">eax</span>
 <span class="mi">804867</span><span class="nl">c</span><span class="p">:</span> <span class="n">e8</span> <span class="mf">2f</span> <span class="n">fd</span> <span class="n">ff</span> <span class="n">ff</span>        <span class="n">call</span>   <span class="mi">80483</span><span class="n">b0</span> <span class="o">&lt;</span><span class="n">printf</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
 <span class="mi">8048681</span><span class="o">:</span> <span class="n">eb</span> <span class="mi">0</span><span class="n">c</span>                 <span class="n">jmp</span>    <span class="mf">804868f</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mh">0x118</span><span class="o">&gt;</span>
 <span class="mi">8048683</span><span class="o">:</span> <span class="n">c7</span> <span class="mo">04</span> <span class="mi">24</span> <span class="n">be</span> <span class="mi">87</span> <span class="mo">04</span> <span class="mi">08</span>  <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="p">],</span><span class="mh">0x80487be</span>
 <span class="mi">804868</span><span class="nl">a</span><span class="p">:</span> <span class="n">e8</span> <span class="mi">41</span> <span class="n">fd</span> <span class="n">ff</span> <span class="n">ff</span>        <span class="n">call</span>   <span class="mi">80483</span><span class="n">d0</span> <span class="o">&lt;</span><span class="n">puts</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
 <span class="mf">804868f</span><span class="o">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">84</span> <span class="mi">24</span> <span class="mi">24</span> <span class="mo">02</span> <span class="mo">00</span> <span class="mo">00</span>  <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x224</span><span class="p">]</span>
 <span class="mi">8048696</span><span class="o">:</span> <span class="mi">89</span> <span class="mo">04</span> <span class="mi">24</span>              <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="p">],</span><span class="n">eax</span>
 <span class="mi">8048699</span><span class="o">:</span> <span class="n">e8</span> <span class="mi">52</span> <span class="n">fd</span> <span class="n">ff</span> <span class="n">ff</span>        <span class="n">call</span>   <span class="mf">80483f</span><span class="mi">0</span> <span class="o">&lt;</span><span class="n">exit</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
 <span class="mi">804869</span><span class="nl">e</span><span class="p">:</span> <span class="mi">90</span>                    <span class="n">nop</span>
 <span class="mf">804869f</span><span class="o">:</span> <span class="mi">90</span>                    <span class="n">nop</span>
</code></pre></div>

<p>I&#8217;ve removed certain non-important sections from the above output. Apart
from <code>main</code>, there are 4 functions, namely <code>checkkey</code>, <code>foo</code>, <code>bar</code>,
<code>foobar</code>. The <code>main</code> function includes certain anti-disassembly and
obfuscation code and it&#8217;s difficult to make proper sense of what&#8217;s
happening here. But let&#8217;s focus on the important instructions. The <code>cmp</code>
set of instructions starting at 0x804860d are interesting, especially
the first <code>cmp</code> itself since it will cause a jump to 0x8048629 if the
input buffer starts with 0x42 (B in ascii) and 0x8048629 is from where
the <code>checkkey</code> function starts. Of all the available functions,
<code>checkkey</code> is of obvious interest and this tells us that the program
will only transfer control to <code>checkkey</code> function if the input starts
with ascii <code>B</code> and not otherwise. Once the control reaches <code>checkkey</code> it
will try to mutate input buffer and compare it against a static key.
Let&#8217;s conclude this analysis by having a closer look at <code>checkkey</code>&#8217;s
disassembly:</p>

<div class="codehilite"><pre><span></span><code><span class="mh">080484c4</span> <span class="p">&lt;</span><span class="nf">checkkey</span><span class="p">&gt;:</span>
 <span class="mi">80484</span><span class="nl">c4</span><span class="p">:</span> <span class="mi">55</span>                    <span class="n">push</span>   <span class="n">ebp</span>
 <span class="mi">80484</span><span class="nl">c5</span><span class="p">:</span> <span class="mi">89</span> <span class="n">e5</span>                 <span class="n">mov</span>    <span class="n">ebp</span><span class="p">,</span><span class="n">esp</span>
 <span class="mi">80484</span><span class="nl">c7</span><span class="p">:</span> <span class="mi">57</span>                    <span class="n">push</span>   <span class="n">edi</span>
 <span class="mi">80484</span><span class="nl">c8</span><span class="p">:</span> <span class="mi">56</span>                    <span class="n">push</span>   <span class="n">esi</span>
 <span class="mi">80484</span><span class="nl">c9</span><span class="p">:</span> <span class="mi">83</span> <span class="n">ec</span> <span class="mi">10</span>              <span class="n">sub</span>    <span class="n">esp</span><span class="p">,</span><span class="mh">0x10</span>
 <span class="mi">80484</span><span class="nl">cc</span><span class="p">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">45</span> <span class="mi">08</span>              <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">+</span><span class="mh">0x8</span><span class="p">]</span>
 <span class="mi">80484</span><span class="nl">cf</span><span class="p">:</span> <span class="mi">89</span> <span class="mi">45</span> <span class="n">f4</span>              <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">-</span><span class="mh">0xc</span><span class="p">],</span><span class="n">eax</span>
 <span class="mi">80484</span><span class="nl">d2</span><span class="p">:</span> <span class="n">eb</span> <span class="mi">14</span>                 <span class="n">jmp</span>    <span class="mf">80484e8</span> <span class="o">&lt;</span><span class="n">checkkey</span><span class="o">+</span><span class="mh">0x24</span><span class="o">&gt;</span>
 <span class="mi">80484</span><span class="nl">d4</span><span class="p">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">45</span> <span class="n">f4</span>              <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">-</span><span class="mh">0xc</span><span class="p">]</span>
 <span class="mi">80484</span><span class="nl">d7</span><span class="p">:</span> <span class="mf">0f</span> <span class="n">b6</span> <span class="mo">00</span>              <span class="n">movzx</span>  <span class="n">eax</span><span class="p">,</span><span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">eax</span><span class="p">]</span>
 <span class="mi">80484</span><span class="nl">da</span><span class="p">:</span> <span class="mi">89</span> <span class="n">c2</span>                 <span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="n">eax</span>
 <span class="mi">80484</span><span class="nl">dc</span><span class="p">:</span> <span class="mi">83</span> <span class="n">f2</span> <span class="mi">2</span><span class="n">a</span>              <span class="n">xor</span>    <span class="n">edx</span><span class="p">,</span><span class="mh">0x2a</span>
 <span class="mi">80484</span><span class="nl">df</span><span class="p">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">45</span> <span class="n">f4</span>              <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">-</span><span class="mh">0xc</span><span class="p">]</span>
 <span class="mf">80484e2</span><span class="o">:</span> <span class="mi">88</span> <span class="mi">10</span>                 <span class="n">mov</span>    <span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">eax</span><span class="p">],</span><span class="n">dl</span>
 <span class="mf">80484e4</span><span class="o">:</span> <span class="mi">83</span> <span class="mi">45</span> <span class="n">f4</span> <span class="mo">01</span>           <span class="n">add</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">-</span><span class="mh">0xc</span><span class="p">],</span><span class="mh">0x1</span>
 <span class="mf">80484e8</span><span class="o">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">45</span> <span class="n">f4</span>              <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">-</span><span class="mh">0xc</span><span class="p">]</span>
 <span class="mi">80484</span><span class="nl">eb</span><span class="p">:</span> <span class="mf">0f</span> <span class="n">b6</span> <span class="mo">00</span>              <span class="n">movzx</span>  <span class="n">eax</span><span class="p">,</span><span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">eax</span><span class="p">]</span>
 <span class="mi">80484</span><span class="nl">ee</span><span class="p">:</span> <span class="mi">84</span> <span class="n">c0</span>                 <span class="n">test</span>   <span class="n">al</span><span class="p">,</span><span class="n">al</span>
 <span class="mf">80484f</span><span class="mi">0</span><span class="o">:</span> <span class="mi">75</span> <span class="n">e2</span>                 <span class="n">jne</span>    <span class="mi">80484</span><span class="n">d4</span> <span class="o">&lt;</span><span class="n">checkkey</span><span class="o">+</span><span class="mh">0x10</span><span class="o">&gt;</span>
 <span class="mf">80484f</span><span class="mi">2</span><span class="o">:</span> <span class="mi">8</span><span class="n">b</span> <span class="mi">45</span> <span class="mi">08</span>              <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">+</span><span class="mh">0x8</span><span class="p">]</span>
 <span class="mf">80484f</span><span class="mi">5</span><span class="o">:</span> <span class="mi">89</span> <span class="n">c2</span>                 <span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="n">eax</span>
 <span class="mf">80484f</span><span class="mi">7</span><span class="o">:</span> <span class="n">b8</span> <span class="mi">70</span> <span class="mi">87</span> <span class="mo">04</span> <span class="mi">08</span>        <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x8048770</span>
 <span class="mf">80484f</span><span class="nl">c</span><span class="p">:</span> <span class="n">b9</span> <span class="mi">19</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span>        <span class="n">mov</span>    <span class="n">ecx</span><span class="p">,</span><span class="mh">0x19</span>
 <span class="mi">8048501</span><span class="o">:</span> <span class="mi">89</span> <span class="n">d6</span>                 <span class="n">mov</span>    <span class="n">esi</span><span class="p">,</span><span class="n">edx</span>
 <span class="mi">8048503</span><span class="o">:</span> <span class="mi">89</span> <span class="n">c7</span>                 <span class="n">mov</span>    <span class="n">edi</span><span class="p">,</span><span class="n">eax</span>
 <span class="mi">8048505</span><span class="o">:</span> <span class="n">f3</span> <span class="n">a6</span>                 <span class="n">repz</span> <span class="n">cmps</span> <span class="n">BYTE</span> <span class="n">PTR</span> <span class="nl">ds</span><span class="p">:[</span><span class="n">esi</span><span class="p">],</span><span class="n">BYTE</span> <span class="n">PTR</span> <span class="nl">es</span><span class="p">:[</span><span class="n">edi</span><span class="p">]</span>
 <span class="mi">8048507</span><span class="o">:</span> <span class="mf">0f</span> <span class="mi">97</span> <span class="n">c2</span>              <span class="n">seta</span>   <span class="n">dl</span>
 <span class="mi">804850</span><span class="nl">a</span><span class="p">:</span> <span class="mf">0f</span> <span class="mi">92</span> <span class="n">c0</span>              <span class="n">setb</span>   <span class="n">al</span>
 <span class="mi">804850</span><span class="nl">d</span><span class="p">:</span> <span class="mi">89</span> <span class="n">d1</span>                 <span class="n">mov</span>    <span class="n">ecx</span><span class="p">,</span><span class="n">edx</span>
 <span class="mf">804850f</span><span class="o">:</span> <span class="mi">28</span> <span class="n">c1</span>                 <span class="n">sub</span>    <span class="n">cl</span><span class="p">,</span><span class="n">al</span>
 <span class="mi">8048511</span><span class="o">:</span> <span class="mi">89</span> <span class="n">c8</span>                 <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">ecx</span>
 <span class="mi">8048513</span><span class="o">:</span> <span class="mf">0f</span> <span class="n">be</span> <span class="n">c0</span>              <span class="n">movsx</span>  <span class="n">eax</span><span class="p">,</span><span class="n">al</span>
 <span class="mi">8048516</span><span class="o">:</span> <span class="mi">85</span> <span class="n">c0</span>                 <span class="n">test</span>   <span class="n">eax</span><span class="p">,</span><span class="n">eax</span>
 <span class="mi">8048518</span><span class="o">:</span> <span class="mi">75</span> <span class="mo">07</span>                 <span class="n">jne</span>    <span class="mi">8048521</span> <span class="o">&lt;</span><span class="n">checkkey</span><span class="o">+</span><span class="mh">0x5d</span><span class="o">&gt;</span>
 <span class="mi">804851</span><span class="nl">a</span><span class="p">:</span> <span class="n">b8</span> <span class="mo">01</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span>        <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x1</span>
 <span class="mf">804851f</span><span class="o">:</span> <span class="n">eb</span> <span class="mo">05</span>                 <span class="n">jmp</span>    <span class="mi">8048526</span> <span class="o">&lt;</span><span class="n">checkkey</span><span class="o">+</span><span class="mh">0x62</span><span class="o">&gt;</span>
 <span class="mi">8048521</span><span class="o">:</span> <span class="n">b8</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mo">00</span>        <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
 <span class="mi">8048526</span><span class="o">:</span> <span class="mi">83</span> <span class="n">c4</span> <span class="mi">10</span>              <span class="n">add</span>    <span class="n">esp</span><span class="p">,</span><span class="mh">0x10</span>
 <span class="mi">8048529</span><span class="o">:</span> <span class="mi">5</span><span class="n">e</span>                    <span class="n">pop</span>    <span class="n">esi</span>
 <span class="mi">804852</span><span class="nl">a</span><span class="p">:</span> <span class="mf">5f</span>                    <span class="n">pop</span>    <span class="n">edi</span>
 <span class="mi">804852</span><span class="nl">b</span><span class="p">:</span> <span class="mi">5</span><span class="n">d</span>                    <span class="n">pop</span>    <span class="n">ebp</span>
 <span class="mi">804852</span><span class="nl">c</span><span class="p">:</span> <span class="n">c3</span>                    <span class="n">ret</span>
</code></pre></div>

<p>After the <a href="http://en.wikipedia.org/wiki/Function_prologue">function
prologue</a>, the
<code>checkkey</code> function is reading the input buffer (starting address at
<code>DWORD PTR [ebp+0x8]</code>) and performs a per-byte XOR using 0x2a as the
key. Once the XOR operation completes, it is indeed comparing the
resultant string with a pre-defined flag of size <code>0x19 - 1</code> bytes stored
at 0x8048770. The <code>mov</code> instructions starting at address 0x80484f2 and
the <code>repz cmps</code> instruction at address 0x8048505 confirm this analysis.</p>

<p>So we now know that the input will be XOR&#8217;ed with a static per-byte key
of 0x2a and the result will be compared with a flag defined at
0x80484f2. To reverse this mutation logic the only remaining piece of
information is the flag. If we obtain the flag and reverse the XOR
operation, we&#8217;ll have a string that will be accepted by the program for
the challenge to complete. From the <code>strings</code> output earlier, we found a
static key-like string, <code>KFFSE_XHKYOKXOHOFEDM^E_Y</code>, which looks like a
very good candidate. Let&#8217;s try to reverse the XOR operation using this
string as the key and 0x2a as XOR key:</p>

<div class="codehilite"><pre><span></span><code><span class="ch">#!/usr//bin/env python</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;USAGE: </span><span class="si">%s</span><span class="s2"> &lt;KFFSE_XHKYOKXOHOFEDM^E_Y&gt; &lt;0x2a&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">flag</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">decoded</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">:</span>
    <span class="n">decoded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">^</span> <span class="n">key</span><span class="p">))</span>

<span class="n">decoded</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">decoded</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> ^ 0x</span><span class="si">%x</span><span class="s2"> =&gt; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">decoded</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>$ ./xor.py KFFSE_XHKYOKXOHOFEDM^E_Y 0x2a
KFFSE_XHKYOKXOHOFEDM^E_Y ^ <span class="nv">0x2a</span> <span class="o">=</span>&gt; allyourbasearebelongtous
$
$ ./reverse-ex
Are you feeling lucky today? Ballyourbasearebelongtous
<span class="o">[</span>+<span class="o">]</span> WooT!: KFFSE_XHKYOKXOHOFEDM^E_Y
</code></pre></div>

<p>Awesome! First run of the program and we get a <em>WooT!</em> message
confirming successful completion of this challenge. It can&#8217;t get better
than this.</p>

<p>Every assumption we made (<code>B</code> at the start of input, mutation logic
based on a static key 0x2a, etc.) about the program was validated via
static analysis except for the flag string used above. We assumed it to
be the XOR result comparison flag stored at address 0x8048505 but didn&#8217;t
validate it in anyway except for trying it out with the binary itself.
Authors of such challenges often add such strings to confuse the analyst
and delay the process. However, validating this assumption is fairly
trivial and let&#8217;s see how to do it. Since, the value stored at this
address could be static or dynamically-computed at runtime, let&#8217;s use
rely on the debugging process to provide us the correct result. We&#8217;ll
debug the program using GDB and check the contents of this address to
validate our assumption:</p>

<div class="codehilite"><pre><span></span><code><span class="err">$</span> <span class="n">gdb</span> <span class="p">.</span><span class="o">/</span><span class="n">reverse</span><span class="o">-</span><span class="n">ex</span> <span class="o">-</span><span class="n">q</span>
<span class="n">Reading</span> <span class="n">symbols</span> <span class="n">from</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ankur</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">challenges</span><span class="o">/</span><span class="n">misc</span><span class="o">/</span><span class="n">reverse</span><span class="o">-</span><span class="n">ex</span><span class="p">...(</span><span class="n">no</span> <span class="n">debugging</span> <span class="n">symbols</span> <span class="n">found</span><span class="p">)...</span><span class="n">done</span><span class="p">.</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">break</span> <span class="n">checkkey</span>
<span class="n">Breakpoint</span> <span class="mi">1</span> <span class="n">at</span> <span class="mh">0x80484c9</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">r</span>
<span class="n">Starting</span> <span class="nl">program</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ankur</span><span class="o">/</span><span class="n">toolbox</span><span class="o">/</span><span class="n">challenges</span><span class="o">/</span><span class="n">misc</span><span class="o">/</span><span class="n">reverse</span><span class="o">-</span><span class="n">ex</span>
<span class="n">Are</span> <span class="n">you</span> <span class="n">feeling</span> <span class="n">lucky</span> <span class="n">today</span><span class="o">?</span> <span class="n">BABCD</span>

<span class="n">Breakpoint</span> <span class="mi">1</span><span class="p">,</span> <span class="mh">0x080484c9</span> <span class="n">in</span> <span class="n">checkkey</span> <span class="p">()</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">disas</span> <span class="n">checkkey</span>
<span class="n">Dump</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">code</span> <span class="k">for</span> <span class="n">function</span> <span class="nl">checkkey</span><span class="p">:</span>
   <span class="mh">0x080484c4</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span> <span class="n">push</span>   <span class="o">%</span><span class="n">ebp</span>
   <span class="mh">0x080484c5</span> <span class="o">&lt;+</span><span class="mi">1</span><span class="o">&gt;:</span> <span class="n">mov</span>    <span class="o">%</span><span class="n">esp</span><span class="p">,</span><span class="o">%</span><span class="n">ebp</span>
   <span class="mh">0x080484c7</span> <span class="o">&lt;+</span><span class="mi">3</span><span class="o">&gt;:</span> <span class="n">push</span>   <span class="o">%</span><span class="n">edi</span>
   <span class="mh">0x080484c8</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;:</span> <span class="n">push</span>   <span class="o">%</span><span class="n">esi</span>
<span class="o">=&gt;</span> <span class="mh">0x080484c9</span> <span class="o">&lt;+</span><span class="mi">5</span><span class="o">&gt;:</span> <span class="n">sub</span>    <span class="err">$</span><span class="mh">0x10</span><span class="p">,</span><span class="o">%</span><span class="n">esp</span>
   <span class="mh">0x080484cc</span> <span class="o">&lt;+</span><span class="mi">8</span><span class="o">&gt;:</span> <span class="n">mov</span>    <span class="mh">0x8</span><span class="p">(</span><span class="o">%</span><span class="n">ebp</span><span class="p">),</span><span class="o">%</span><span class="n">eax</span>
   <span class="mh">0x080484cf</span> <span class="o">&lt;+</span><span class="mi">11</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="o">%</span><span class="n">eax</span><span class="p">,</span><span class="o">-</span><span class="mh">0xc</span><span class="p">(</span><span class="o">%</span><span class="n">ebp</span><span class="p">)</span>
   <span class="mh">0x080484d2</span> <span class="o">&lt;+</span><span class="mi">14</span><span class="o">&gt;:</span>  <span class="n">jmp</span>    <span class="mh">0x80484e8</span> <span class="o">&lt;</span><span class="n">checkkey</span><span class="o">+</span><span class="mi">36</span><span class="o">&gt;</span>
   <span class="mh">0x080484d4</span> <span class="o">&lt;+</span><span class="mi">16</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="o">-</span><span class="mh">0xc</span><span class="p">(</span><span class="o">%</span><span class="n">ebp</span><span class="p">),</span><span class="o">%</span><span class="n">eax</span>
   <span class="mh">0x080484d7</span> <span class="o">&lt;+</span><span class="mi">19</span><span class="o">&gt;:</span>  <span class="n">movzbl</span> <span class="p">(</span><span class="o">%</span><span class="n">eax</span><span class="p">),</span><span class="o">%</span><span class="n">eax</span>
   <span class="mh">0x080484da</span> <span class="o">&lt;+</span><span class="mi">22</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="o">%</span><span class="n">eax</span><span class="p">,</span><span class="o">%</span><span class="n">edx</span>
   <span class="mh">0x080484dc</span> <span class="o">&lt;+</span><span class="mi">24</span><span class="o">&gt;:</span>  <span class="n">xor</span>    <span class="err">$</span><span class="mh">0x2a</span><span class="p">,</span><span class="o">%</span><span class="n">edx</span>
   <span class="mh">0x080484df</span> <span class="o">&lt;+</span><span class="mi">27</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="o">-</span><span class="mh">0xc</span><span class="p">(</span><span class="o">%</span><span class="n">ebp</span><span class="p">),</span><span class="o">%</span><span class="n">eax</span>
   <span class="mh">0x080484e2</span> <span class="o">&lt;+</span><span class="mi">30</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="o">%</span><span class="n">dl</span><span class="p">,(</span><span class="o">%</span><span class="n">eax</span><span class="p">)</span>
   <span class="mh">0x080484e4</span> <span class="o">&lt;+</span><span class="mi">32</span><span class="o">&gt;:</span>  <span class="n">addl</span>   <span class="err">$</span><span class="mh">0x1</span><span class="p">,</span><span class="o">-</span><span class="mh">0xc</span><span class="p">(</span><span class="o">%</span><span class="n">ebp</span><span class="p">)</span>
   <span class="mh">0x080484e8</span> <span class="o">&lt;+</span><span class="mi">36</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="o">-</span><span class="mh">0xc</span><span class="p">(</span><span class="o">%</span><span class="n">ebp</span><span class="p">),</span><span class="o">%</span><span class="n">eax</span>
   <span class="mh">0x080484eb</span> <span class="o">&lt;+</span><span class="mi">39</span><span class="o">&gt;:</span>  <span class="n">movzbl</span> <span class="p">(</span><span class="o">%</span><span class="n">eax</span><span class="p">),</span><span class="o">%</span><span class="n">eax</span>
   <span class="mh">0x080484ee</span> <span class="o">&lt;+</span><span class="mi">42</span><span class="o">&gt;:</span>  <span class="n">test</span>   <span class="o">%</span><span class="n">al</span><span class="p">,</span><span class="o">%</span><span class="n">al</span>
   <span class="mh">0x080484f0</span> <span class="o">&lt;+</span><span class="mi">44</span><span class="o">&gt;:</span>  <span class="n">jne</span>    <span class="mh">0x80484d4</span> <span class="o">&lt;</span><span class="n">checkkey</span><span class="o">+</span><span class="mi">16</span><span class="o">&gt;</span>
   <span class="mh">0x080484f2</span> <span class="o">&lt;+</span><span class="mi">46</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="mh">0x8</span><span class="p">(</span><span class="o">%</span><span class="n">ebp</span><span class="p">),</span><span class="o">%</span><span class="n">eax</span>
   <span class="mh">0x080484f5</span> <span class="o">&lt;+</span><span class="mi">49</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="o">%</span><span class="n">eax</span><span class="p">,</span><span class="o">%</span><span class="n">edx</span>
   <span class="mh">0x080484f7</span> <span class="o">&lt;+</span><span class="mi">51</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="err">$</span><span class="mh">0x8048770</span><span class="p">,</span><span class="o">%</span><span class="n">eax</span>
   <span class="mh">0x080484fc</span> <span class="o">&lt;+</span><span class="mi">56</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="err">$</span><span class="mh">0x19</span><span class="p">,</span><span class="o">%</span><span class="n">ecx</span>
   <span class="mh">0x08048501</span> <span class="o">&lt;+</span><span class="mi">61</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="o">%</span><span class="n">edx</span><span class="p">,</span><span class="o">%</span><span class="n">esi</span>
   <span class="mh">0x08048503</span> <span class="o">&lt;+</span><span class="mi">63</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="o">%</span><span class="n">eax</span><span class="p">,</span><span class="o">%</span><span class="n">edi</span>
   <span class="mh">0x08048505</span> <span class="o">&lt;+</span><span class="mi">65</span><span class="o">&gt;:</span>  <span class="n">repz</span> <span class="n">cmpsb</span> <span class="o">%</span><span class="nl">es</span><span class="p">:(</span><span class="o">%</span><span class="n">edi</span><span class="p">),</span><span class="o">%</span><span class="nl">ds</span><span class="p">:(</span><span class="o">%</span><span class="n">esi</span><span class="p">)</span>
   <span class="mh">0x08048507</span> <span class="o">&lt;+</span><span class="mi">67</span><span class="o">&gt;:</span>  <span class="n">seta</span>   <span class="o">%</span><span class="n">dl</span>
   <span class="mh">0x0804850a</span> <span class="o">&lt;+</span><span class="mi">70</span><span class="o">&gt;:</span>  <span class="n">setb</span>   <span class="o">%</span><span class="n">al</span>
   <span class="mh">0x0804850d</span> <span class="o">&lt;+</span><span class="mi">73</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="o">%</span><span class="n">edx</span><span class="p">,</span><span class="o">%</span><span class="n">ecx</span>
   <span class="mh">0x0804850f</span> <span class="o">&lt;+</span><span class="mi">75</span><span class="o">&gt;:</span>  <span class="n">sub</span>    <span class="o">%</span><span class="n">al</span><span class="p">,</span><span class="o">%</span><span class="n">cl</span>
   <span class="mh">0x08048511</span> <span class="o">&lt;+</span><span class="mi">77</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="o">%</span><span class="n">ecx</span><span class="p">,</span><span class="o">%</span><span class="n">eax</span>
   <span class="mh">0x08048513</span> <span class="o">&lt;+</span><span class="mi">79</span><span class="o">&gt;:</span>  <span class="n">movsbl</span> <span class="o">%</span><span class="n">al</span><span class="p">,</span><span class="o">%</span><span class="n">eax</span>
   <span class="mh">0x08048516</span> <span class="o">&lt;+</span><span class="mi">82</span><span class="o">&gt;:</span>  <span class="n">test</span>   <span class="o">%</span><span class="n">eax</span><span class="p">,</span><span class="o">%</span><span class="n">eax</span>
   <span class="mh">0x08048518</span> <span class="o">&lt;+</span><span class="mi">84</span><span class="o">&gt;:</span>  <span class="n">jne</span>    <span class="mh">0x8048521</span> <span class="o">&lt;</span><span class="n">checkkey</span><span class="o">+</span><span class="mi">93</span><span class="o">&gt;</span>
   <span class="mh">0x0804851a</span> <span class="o">&lt;+</span><span class="mi">86</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="err">$</span><span class="mh">0x1</span><span class="p">,</span><span class="o">%</span><span class="n">eax</span>
   <span class="mh">0x0804851f</span> <span class="o">&lt;+</span><span class="mi">91</span><span class="o">&gt;:</span>  <span class="n">jmp</span>    <span class="mh">0x8048526</span> <span class="o">&lt;</span><span class="n">checkkey</span><span class="o">+</span><span class="mi">98</span><span class="o">&gt;</span>
   <span class="mh">0x08048521</span> <span class="o">&lt;+</span><span class="mi">93</span><span class="o">&gt;:</span>  <span class="n">mov</span>    <span class="err">$</span><span class="mh">0x0</span><span class="p">,</span><span class="o">%</span><span class="n">eax</span>
   <span class="mh">0x08048526</span> <span class="o">&lt;+</span><span class="mi">98</span><span class="o">&gt;:</span>  <span class="n">add</span>    <span class="err">$</span><span class="mh">0x10</span><span class="p">,</span><span class="o">%</span><span class="n">esp</span>
   <span class="mh">0x08048529</span> <span class="o">&lt;+</span><span class="mi">101</span><span class="o">&gt;:</span> <span class="n">pop</span>    <span class="o">%</span><span class="n">esi</span>
   <span class="mh">0x0804852a</span> <span class="o">&lt;+</span><span class="mi">102</span><span class="o">&gt;:</span> <span class="n">pop</span>    <span class="o">%</span><span class="n">edi</span>
   <span class="mh">0x0804852b</span> <span class="o">&lt;+</span><span class="mi">103</span><span class="o">&gt;:</span> <span class="n">pop</span>    <span class="o">%</span><span class="n">ebp</span>
   <span class="mh">0x0804852c</span> <span class="o">&lt;+</span><span class="mi">104</span><span class="o">&gt;:</span> <span class="n">ret</span>
<span class="n">End</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">dump</span><span class="p">.</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">x</span> <span class="o">/</span><span class="n">s</span> <span class="mh">0x8048770</span>
<span class="mh">0x8048770</span><span class="o">:</span>   <span class="s">&quot;KFFSE_XHKYOKXOHOFEDM^E_Y&quot;</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">q</span>
<span class="n">A</span> <span class="n">debugging</span> <span class="n">session</span> <span class="n">is</span> <span class="n">active</span><span class="p">.</span>

  <span class="n">Inferior</span> <span class="mi">1</span> <span class="p">[</span><span class="n">process</span> <span class="mi">13283</span><span class="p">]</span> <span class="n">will</span> <span class="n">be</span> <span class="n">killed</span><span class="p">.</span>

<span class="n">Quit</span> <span class="n">anyway</span><span class="o">?</span> <span class="p">(</span><span class="n">y</span> <span class="n">or</span> <span class="n">n</span><span class="p">)</span> <span class="n">y</span>
</code></pre></div>

<p>We add a breakpoint at <code>checkkey</code> function and manually inspect the
content of the 0x8048770 address (it might change on our system) and it
indeed turns out to be <code>KFFSE_XHKYOKXOHOFEDM^E_Y</code>. This concludes this
writeup and in an <a href="/2013/malsoftware-reverse-challenge.html">upcoming post</a> I&#8217;ll write about the second challenge
from this course.</p>

        </div>
        <div class="meta">
          <hr/>
          <p>For comments, questions and suggestions use <a href="https://twitter.com/7h3rAm" target="_blank">twitter</a> or create an <a href="https://github.com/7h3rAm/7h3rAm.github.io/issues/new" target="_blank">issue</a> on blog repository.</p>
          <hr/>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <table>
                <tr>
                  <td align="left">(share via <a href="mailto:?subject=reverse-ex Challenge from Coursera's Malicious Software Course&body=http://7h3ram.github.io//2013/malsoftware-reverse-ex.html" target="_blank" title="Share via Email">mail</a>, <a href="http://twitter.com/intent/tweet?text=reverse-ex Challenge from Coursera's Malicious Software Course+http://7h3ram.github.io//2013/malsoftware-reverse-ex.html&via=7h3rAm" target="_blank" title="Share on Twitter">twitter</a>, <a href="http://www.facebook.com/sharer/sharer.php?s=100&p[url]=http://7h3ram.github.io//2013/malsoftware-reverse-ex.html&p[images][0]=&p[title]=reverse-ex Challenge from Coursera's Malicious Software Course&p[summary]=The recently concluded Malicious Software course on Coursera had an interesting reversing challenge reverse-ex. This is a writeup on how to complete it." target="_blank" title="Share on Facebook">facebook</a> or <a href="https://plus.google.com/share?url=http://7h3ram.github.io//2013/malsoftware-reverse-ex.html" target="_blank" title="Share on Google Plus">google-plus</a>)</td>
                  <td align="right">(tagged <a href=/tags.html#reversing>reversing</a> and <a href=/tags.html#writeups>writeups</a>)</td>
                </tr>
                <tr>
                                      <td align="left"><a href="/2013/libnids-pynids.html">&lt;&lt; Network Stream Reassembly and Defragmentation &lt;&lt;</a></td>
                    <td align="right"><a href="/2013/malsoftware-reverse-challenge.html">&gt;&gt; reverse Challenge from Coursera's Malicious Software Course &gt;&gt;</a></td>
                                  </tr>
              </table>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </div>
        </div>
      </div>
    </div>
  </div>
  </article>
              <div class="footer">
          <center>
            <a href="/rss.xml" target="_blank">rss</a> | <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license" target="_blank">license</a>
          </center>
        </div>
          </section>
  </body>
</html>